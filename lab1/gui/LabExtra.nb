(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 8.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[    139776,       3339]
NotebookOptionsPosition[    137833,       3276]
NotebookOutlinePosition[    138218,       3293]
CellTagsIndexPosition[    138175,       3290]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[TextData[StyleBox["Detect platform and establish link to computational \
module", "Subsubtitle",
 Editable->True]], "Input",
 Evaluatable->False,
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"$HistoryLength", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Check", "[", 
   RowBox[{
    RowBox[{"Install", "[", 
     RowBox[{
      RowBox[{"NotebookDirectory", "[", "]"}], "<>", " ", "$OperatingSystem", 
      "<>", "\"\<_\>\"", "<>", "$ProcessorType", "<>", "$PathnameSeparator", 
      "<>", "\"\<GasLink.exe\>\""}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"MessageDialog", "[", 
      RowBox[{
       RowBox[{
       "\"\<No GasLink module was loaded for your platform (\>\"", "<>", 
        "$OperatingSystem", "<>", "\"\< and \>\"", "<>", "$ProcessorType", 
        "<>", "\"\<)\>\""}], ",", 
       RowBox[{"WindowTitle", "\[Rule]", "\"\<Error\>\""}]}], "]"}], ";", " ",
      "\[IndentingNewLine]", 
     RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";"}]}], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Utility functions", "Subsubtitle"]], "Input",
 Evaluatable->False,
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 FormatType->"TextForm"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"StencilToMuNu", "[", "stencil_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"i", ",", "np", ",", "\[Mu]", ",", "\[Nu]"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"np", "=", 
       RowBox[{"Max", "@", 
        RowBox[{"Flatten", "[", 
         RowBox[{"stencil", "/.", 
          RowBox[{"False", "\[Rule]", "0"}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Nu]", "=", 
       RowBox[{"\[Mu]", "=", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"Null", ",", "np"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"i", "=", 
              RowBox[{"stencil", "\[LeftDoubleBracket]", 
               RowBox[{"j", ",", "k"}], "\[RightDoubleBracket]"}]}], ")"}], 
            ">", "0"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{
             "\[Mu]", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
             "=", 
             RowBox[{"k", "-", "3"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
             "\[Nu]", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
             "=", 
             RowBox[{"2", "-", "j"}]}]}]}], "\[IndentingNewLine]", "]"}], 
         ";"}], "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "3"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", "5"}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"{", 
       RowBox[{"\[Mu]", ",", "\[Nu]"}], "}"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DotPoint", "[", 
    RowBox[{
    "schm_", ",", "\[Sigma]_", ",", "col_", ",", "col2_", ",", "lbl_", ",", 
     "sz_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "p", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"p", "=", 
       RowBox[{
        RowBox[{"schm", "[", "\[Sigma]", "]"}], "\[LeftDoubleBracket]", 
        RowBox[{";;", "2"}], "\[RightDoubleBracket]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Graphics", "[", 
       RowBox[{"{", 
        RowBox[{"col", ",", 
         RowBox[{"Disk", "[", 
          RowBox[{"p", ",", 
           FractionBox["sz", "1000"]}], "]"}], ",", 
         RowBox[{"Text", "[", 
          RowBox[{
           RowBox[{"Style", "[", 
            RowBox[{"lbl", ",", "Small", ",", "Bold", ",", "col2"}], "]"}], 
           ",", "p", ",", 
           RowBox[{"FormatType", "\[Rule]", "StandardForm"}]}], "]"}]}], 
        "}"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CoeffToHuman", "[", "ss_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
      "schm", ",", "stencil", ",", "\[IndentingNewLine]", "sig", ",", "alph", 
       ",", "\[Sigma]", ",", "\[IndentingNewLine]", "\[Nu]", ",", "\[Mu]"}], 
      "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"schm", ",", "stencil"}], "}"}], "=", "ss"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\[Mu]", ",", "\[Nu]"}], "}"}], "=", 
       RowBox[{"StencilToMuNu", "[", "stencil", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"sig", "=", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "\"\<\!\(\*SubsuperscriptBox[\(u\), \(m - 2\), \(n + 1\)]\)\>\"", 
           ",", "\"\<\!\(\*SubsuperscriptBox[\(u\), \(m - 1\), \(n + 1\)]\)\>\
\"", ",", "\"\<\!\(\*SubsuperscriptBox[\(u\), \(m\), \(n + 1\)]\)\>\"", ",", 
           "\"\<\!\(\*SubsuperscriptBox[\(u\), \(m + 1\), \(n + 1\)]\)\>\"", 
           ",", "\"\<\!\(\*SubsuperscriptBox[\(u\), \(m + 2\), \(n + 1\)]\)\>\
\""}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
          "\"\<\!\(\*SubsuperscriptBox[\(u\), \(m - 2\), \(n\)]\)\>\"", ",", 
           "\"\<\!\(\*SubsuperscriptBox[\(u\), \(m - 1\), \(n\)]\)\>\"", ",", 
           "\"\<\!\(\*SubsuperscriptBox[\(u\), \(m\), \(n\)]\)\>\"", ",", 
           "\"\<\!\(\*SubsuperscriptBox[\(u\), \(m + 1\), \(n\)]\)\>\"", ",", 
           "\"\<\!\(\*SubsuperscriptBox[\(u\), \(m + 2\), \(n\)]\)\>\""}], 
          "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
          "\"\<\!\(\*SubsuperscriptBox[\(u\), \(m - 2\), \(n - 1\)]\)\>\"", 
           ",", "\"\<\!\(\*SubsuperscriptBox[\(u\), \(m - 1\), \(n - 1\)]\)\>\
\"", ",", "\"\<\!\(\*SubsuperscriptBox[\(u\), \(m\), \(n - 1\)]\)\>\"", ",", 
           "\"\<\!\(\*SubsuperscriptBox[\(u\), \(m + 1\), \(n - 1\)]\)\>\"", 
           ",", "\"\<\!\(\*SubsuperscriptBox[\(u\), \(m + 2\), \(n - 1\)]\)\>\
\""}], "}"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"alph", "=", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "\"\<\!\(\*SubsuperscriptBox[\(\[Alpha]\), \(-2\), \(1\)]\)\>\"", 
           ",", "\"\<\!\(\*SubsuperscriptBox[\(\[Alpha]\), \(-1\), \(1\)]\)\>\
\"", ",", "\"\<\!\(\*SubsuperscriptBox[\(\[Alpha]\), \(0\), \(1\)]\)\>\"", 
           ",", "\"\<\!\(\*SubsuperscriptBox[\(\[Alpha]\), \(1\), \
\(1\)]\)\>\"", ",", 
           "\"\<\!\(\*SubsuperscriptBox[\(\[Alpha]\), \(2\), \(1\)]\)\>\""}], 
          "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
          "\"\<\!\(\*SubsuperscriptBox[\(\[Alpha]\), \(-2\), \(0\)]\)\>\"", 
           ",", "\"\<\!\(\*SubsuperscriptBox[\(\[Alpha]\), \(-1\), \(0\)]\)\>\
\"", ",", "\"\<\!\(\*SubsuperscriptBox[\(\[Alpha]\), \(0\), \(0\)]\)\>\"", 
           ",", "\"\<\!\(\*SubsuperscriptBox[\(\[Alpha]\), \(1\), \
\(0\)]\)\>\"", ",", 
           "\"\<\!\(\*SubsuperscriptBox[\(\[Alpha]\), \(2\), \(0\)]\)\>\""}], 
          "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
          "\"\<\!\(\*SubsuperscriptBox[\(\[Alpha]\), \(-2\), \(-1\)]\)\>\"", 
           ",", "\"\<\!\(\*SubsuperscriptBox[\(\[Alpha]\), \(-1\), \
\(-1\)]\)\>\"", ",", 
           "\"\<\!\(\*SubsuperscriptBox[\(\[Alpha]\), \(0\), \(-1\)]\)\>\"", 
           ",", "\"\<\!\(\*SubsuperscriptBox[\(\[Alpha]\), \(1\), \(-1\)]\)\>\
\"", ",", "\"\<\!\(\*SubsuperscriptBox[\(\[Alpha]\), \(2\), \(-1\)]\)\>\""}], 
          "}"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Row", "[", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"TraditionalForm", "@", 
          RowBox[{"sig", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "3"}], "\[RightDoubleBracket]"}]}], ",", 
         "\"\<=\>\"", ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"TraditionalForm", "@", 
           RowBox[{"Sum", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"sig", "\[LeftDoubleBracket]", 
               RowBox[{
                RowBox[{"2", "-", 
                 RowBox[{
                 "\[Nu]", "\[LeftDoubleBracket]", "i", 
                  "\[RightDoubleBracket]"}]}], ",", 
                RowBox[{
                 RowBox[{
                 "\[Mu]", "\[LeftDoubleBracket]", "i", 
                  "\[RightDoubleBracket]"}], "-", "3"}]}], 
               "\[RightDoubleBracket]"}], "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"schm", "[", 
                RowBox[{"\[Sigma]", ",", "\[IndentingNewLine]", 
                 RowBox[{"alph", "\[LeftDoubleBracket]", 
                  RowBox[{
                   RowBox[{"2", "-", 
                    RowBox[{
                    "\[Nu]", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}]}], ",", 
                   RowBox[{
                    RowBox[{
                    "\[Mu]", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "-", "3"}]}], 
                  "\[RightDoubleBracket]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"alph", "\[LeftDoubleBracket]", 
                  RowBox[{
                   RowBox[{"2", "-", 
                    RowBox[{
                    "\[Nu]", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}]}], ",", 
                   RowBox[{
                    RowBox[{
                    "\[Mu]", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], "-", "3"}]}], 
                  "\[RightDoubleBracket]"}]}], "\[IndentingNewLine]", "]"}], 
               "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], ",", 
             
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{"Length", "@", "\[Mu]"}]}], "}"}]}], "]"}]}], "/.", 
          RowBox[{"\[Sigma]", "\[Rule]", "\"\<\[Sigma]\>\""}]}]}], 
        "\[IndentingNewLine]", "}"}], "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CoeffToDeltas", "[", "ss_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
      "schm", ",", "stencil", ",", "\[IndentingNewLine]", "f", ",", "p", ",", 
       "q", ",", "r", ",", "\[Sigma]", ",", "\[IndentingNewLine]", 
       RowBox[{"coeff", "=", 
        RowBox[{"Table", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", "13", "}"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
       "alph", ",", "tr", ",", "\[IndentingNewLine]", 
       RowBox[{"deltas", "=", 
        RowBox[{"Table", "[", 
         RowBox[{"Null", ",", 
          RowBox[{"{", "10", "}"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"idx", "=", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "1", ",", "2", ",", "3", ",", "0"}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"4", ",", "5", ",", "6", ",", "7", ",", "8"}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"9", ",", "10", ",", "11", ",", "12", ",", "13"}], "}"}]}],
          "}"}]}], ",", "\[IndentingNewLine]", "\[Nu]", ",", "\[Mu]"}], 
      "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"schm", ",", "stencil"}], "}"}], "=", "ss"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"schm", "===", "Null"}], ",", 
        RowBox[{"Return", "[", "Null", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\[Mu]", ",", "\[Nu]"}], "}"}], "=", 
       RowBox[{"StencilToMuNu", "[", "stencil", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"r", "=", 
          RowBox[{"idx", "\[LeftDoubleBracket]", 
           RowBox[{
            RowBox[{"2", "-", 
             RowBox[{
             "\[Nu]", "\[LeftDoubleBracket]", "s", 
              "\[RightDoubleBracket]"}]}], ",", 
            RowBox[{
             RowBox[{
             "\[Mu]", "\[LeftDoubleBracket]", "s", "\[RightDoubleBracket]"}], 
             "+", "3"}]}], "\[RightDoubleBracket]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
          "coeff", "\[LeftDoubleBracket]", "r", "\[RightDoubleBracket]"}], 
          "=", 
          RowBox[{
           RowBox[{"schm", "[", "\[Sigma]", "]"}], "\[LeftDoubleBracket]", 
           "s", "\[RightDoubleBracket]"}]}], ";"}], "\[IndentingNewLine]", 
        ",", 
        RowBox[{"{", 
         RowBox[{"s", ",", 
          RowBox[{"Length", "@", "\[Mu]"}]}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
       "coeff", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], "=", 
       RowBox[{"-", "1"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"r", "=", 
       RowBox[{"Simplify", "[", 
        RowBox[{
         RowBox[{"Total", "[", 
          RowBox[{"coeff", "\[LeftDoubleBracket]", 
           RowBox[{"1", ";;", "3"}], "\[RightDoubleBracket]"}], "]"}], "-", 
         RowBox[{"Total", "[", 
          RowBox[{"coeff", "\[LeftDoubleBracket]", 
           RowBox[{"9", ";;", "13"}], "\[RightDoubleBracket]"}], "]"}]}], 
        "]"}]}], ";", " ", 
      RowBox[{"(*", 
       RowBox[{"\[Sum]", 
        SubsuperscriptBox["\[Nu]\[Alpha]", "\[Mu]", "\[Nu]"]}], "*)"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"r", "\[Equal]", "0"}], ",", 
        RowBox[{"Return", "[", "Null", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"coeff", "/=", "r"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"alph", "=", "\[IndentingNewLine]", 
       RowBox[{"{", "              ", 
        RowBox[{
        "\"\<\!\(\*SubscriptBox[OverscriptBox[\(\[Alpha]\), \(^\)], \(-1\)]\)\
\>\"", ",", 
         "\"\<\!\(\*SubscriptBox[OverscriptBox[\(\[Alpha]\), \(^\)], \(0\)]\)\
\>\"", ",", 
         "\"\<\!\(\*SubscriptBox[OverscriptBox[\(\[Alpha]\), \(^\)], \(1\)]\)\
\>\"", ",", "\[IndentingNewLine]", 
         "\"\<\!\(\*SubscriptBox[\(\[Alpha]\), \(-2\)]\)\>\"", ",", 
         "\"\<\!\(\*SubscriptBox[\(\[Alpha]\), \(-1\)]\)\>\"", ",", 
         "\"\<\!\(\*SubscriptBox[\(\[Alpha]\), \(0\)]\)\>\"", ",", 
         "\"\<\!\(\*SubscriptBox[\(\[Alpha]\), \(1\)]\)\>\"", ",", 
         "\"\<\!\(\*SubscriptBox[\(\[Alpha]\), \(2\)]\)\>\"", ",", 
         "\[IndentingNewLine]", 
         "\"\<\!\(\*SubscriptBox[OverscriptBox[\(\[Alpha]\), \(\[Hacek]\)], \
\(-2\)]\)\>\"", ",", 
         "\"\<\!\(\*SubscriptBox[OverscriptBox[\(\[Alpha]\), \(\[Hacek]\)], \
\(-1\)]\)\>\"", ",", 
         "\"\<\!\(\*SubscriptBox[OverscriptBox[\(\[Alpha]\), \(\[Hacek]\)], \
\(0\)]\)\>\"", ",", 
         "\"\<\!\(\*SubscriptBox[OverscriptBox[\(\[Alpha]\), \(\[Hacek]\)], \
\(1\)]\)\>\"", ",", 
         "\"\<\!\(\*SubscriptBox[OverscriptBox[\(\[Alpha]\), \(\[Hacek]\)], \
\(2\)]\)\>\""}], "}"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"tr", "[", 
          RowBox[{
          "alph", "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}], 
          "]"}], "=", "j"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "13"}], "}"}]}], "]"}], ";", "\[IndentingNewLine]",
       "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
       "deltas", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "=", 
       
       RowBox[{"coeff", "\[LeftDoubleBracket]", 
        RowBox[{
        "tr", "@", 
         "\"\<\!\(\*SubscriptBox[OverscriptBox[\(\[Alpha]\), \(^\)], \
\(-1\)]\)\>\""}], "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
       "deltas", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], "=", 
       
       RowBox[{
        RowBox[{"coeff", "\[LeftDoubleBracket]", 
         RowBox[{
         "tr", "@", 
          "\"\<\!\(\*SubscriptBox[OverscriptBox[\(\[Alpha]\), \(^\)], \
\(0\)]\)\>\""}], "\[RightDoubleBracket]"}], "-", 
        RowBox[{"1", "/", "2"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
       "deltas", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], "=", 
       
       RowBox[{"coeff", "\[LeftDoubleBracket]", 
        RowBox[{
        "tr", "@", 
         "\"\<\!\(\*SubscriptBox[OverscriptBox[\(\[Alpha]\), \(^\)], \(1\)]\)\
\>\""}], "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
       "deltas", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}], "=", 
       
       RowBox[{"coeff", "\[LeftDoubleBracket]", 
        RowBox[{
        "tr", "@", 
         "\"\<\!\(\*SubscriptBox[OverscriptBox[\(\[Alpha]\), \(\[Hacek]\)], \
\(-2\)]\)\>\""}], "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
       "deltas", "\[LeftDoubleBracket]", "5", "\[RightDoubleBracket]"}], "=", 
       
       RowBox[{
        RowBox[{"coeff", "\[LeftDoubleBracket]", 
         RowBox[{
         "tr", "@", 
          "\"\<\!\(\*SubscriptBox[OverscriptBox[\(\[Alpha]\), \(\[Hacek]\)], \
\(-2\)]\)\>\""}], "\[RightDoubleBracket]"}], "+", 
        RowBox[{"coeff", "\[LeftDoubleBracket]", 
         RowBox[{
         "tr", "@", 
          "\"\<\!\(\*SubscriptBox[OverscriptBox[\(\[Alpha]\), \(\[Hacek]\)], \
\(-1\)]\)\>\""}], "\[RightDoubleBracket]"}], "-", 
        RowBox[{"coeff", "\[LeftDoubleBracket]", 
         RowBox[{
         "tr", "@", 
          "\"\<\!\(\*SubscriptBox[OverscriptBox[\(\[Alpha]\), \(^\)], \(-1\)]\
\)\>\""}], "\[RightDoubleBracket]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
       "deltas", "\[LeftDoubleBracket]", "6", "\[RightDoubleBracket]"}], "=", 
       
       RowBox[{
        RowBox[{"-", 
         RowBox[{"coeff", "\[LeftDoubleBracket]", 
          RowBox[{
          "tr", "@", 
           "\"\<\!\(\*SubscriptBox[OverscriptBox[\(\[Alpha]\), \(\[Hacek]\)], \
\(1\)]\)\>\""}], "\[RightDoubleBracket]"}]}], "-", 
        RowBox[{"coeff", "\[LeftDoubleBracket]", 
         RowBox[{
         "tr", "@", 
          "\"\<\!\(\*SubscriptBox[OverscriptBox[\(\[Alpha]\), \(\[Hacek]\)], \
\(2\)]\)\>\""}], "\[RightDoubleBracket]"}], "+", 
        RowBox[{"coeff", "\[LeftDoubleBracket]", 
         RowBox[{
         "tr", "@", 
          "\"\<\!\(\*SubscriptBox[OverscriptBox[\(\[Alpha]\), \(^\)], \
\(1\)]\)\>\""}], "\[RightDoubleBracket]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
       "deltas", "\[LeftDoubleBracket]", "7", "\[RightDoubleBracket]"}], "=", 
       
       RowBox[{"-", 
        RowBox[{"coeff", "\[LeftDoubleBracket]", 
         RowBox[{
         "tr", "@", 
          "\"\<\!\(\*SubscriptBox[OverscriptBox[\(\[Alpha]\), \(\[Hacek]\)], \
\(2\)]\)\>\""}], "\[RightDoubleBracket]"}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
       "deltas", "\[LeftDoubleBracket]", "8", "\[RightDoubleBracket]"}], "=", 
       
       RowBox[{
        RowBox[{"coeff", "\[LeftDoubleBracket]", 
         RowBox[{
         "tr", "@", 
          "\"\<\!\(\*SubscriptBox[OverscriptBox[\(\[Alpha]\), \(\[Hacek]\)], \
\(-2\)]\)\>\""}], "\[RightDoubleBracket]"}], "+", 
        RowBox[{"coeff", "\[LeftDoubleBracket]", 
         RowBox[{
         "tr", "@", "\"\<\!\(\*SubscriptBox[\(\[Alpha]\), \(-2\)]\)\>\""}], 
         "\[RightDoubleBracket]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
       "deltas", "\[LeftDoubleBracket]", "9", "\[RightDoubleBracket]"}], "=", 
       
       RowBox[{
        RowBox[{"1", "/", "2"}], 
        RowBox[{"(", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"coeff", "\[LeftDoubleBracket]", 
           RowBox[{
           "tr", "@", 
            "\"\<\!\(\*SubscriptBox[OverscriptBox[\(\[Alpha]\), \
\(\[Hacek]\)], \(-2\)]\)\>\""}], "\[RightDoubleBracket]"}], "-", 
          RowBox[{"coeff", "\[LeftDoubleBracket]", 
           RowBox[{
           "tr", "@", 
            "\"\<\!\(\*SubscriptBox[OverscriptBox[\(\[Alpha]\), \
\(\[Hacek]\)], \(0\)]\)\>\""}], "\[RightDoubleBracket]"}], "+", 
          RowBox[{"coeff", "\[LeftDoubleBracket]", 
           RowBox[{
           "tr", "@", 
            "\"\<\!\(\*SubscriptBox[OverscriptBox[\(\[Alpha]\), \
\(\[Hacek]\)], \(2\)]\)\>\""}], "\[RightDoubleBracket]"}], 
          "\[IndentingNewLine]", "+", 
          RowBox[{"coeff", "\[LeftDoubleBracket]", 
           RowBox[{
           "tr", "@", "\"\<\!\(\*SubscriptBox[\(\[Alpha]\), \(-2\)]\)\>\""}], 
           "\[RightDoubleBracket]"}], "-", 
          RowBox[{"coeff", "\[LeftDoubleBracket]", 
           RowBox[{
           "tr", "@", "\"\<\!\(\*SubscriptBox[\(\[Alpha]\), \(0\)]\)\>\""}], 
           "\[RightDoubleBracket]"}], "+", 
          RowBox[{"coeff", "\[LeftDoubleBracket]", 
           RowBox[{
           "tr", "@", "\"\<\!\(\*SubscriptBox[\(\[Alpha]\), \(2\)]\)\>\""}], 
           "\[RightDoubleBracket]"}], "\[IndentingNewLine]", "-", 
          RowBox[{"coeff", "\[LeftDoubleBracket]", 
           RowBox[{
           "tr", "@", 
            
            "\"\<\!\(\*SubscriptBox[OverscriptBox[\(\[Alpha]\), \(^\)], \
\(0\)]\)\>\""}], "\[RightDoubleBracket]"}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
       "deltas", "\[LeftDoubleBracket]", "10", "\[RightDoubleBracket]"}], "=", 
       RowBox[{
        RowBox[{"coeff", "\[LeftDoubleBracket]", 
         RowBox[{
         "tr", "@", 
          "\"\<\!\(\*SubscriptBox[OverscriptBox[\(\[Alpha]\), \(\[Hacek]\)], \
\(2\)]\)\>\""}], "\[RightDoubleBracket]"}], "+", 
        RowBox[{"coeff", "\[LeftDoubleBracket]", 
         RowBox[{
         "tr", "@", "\"\<\!\(\*SubscriptBox[\(\[Alpha]\), \(2\)]\)\>\""}], 
         "\[RightDoubleBracket]"}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"f", "=", 
          RowBox[{"Together", "@", 
           RowBox[{
           "deltas", "\[LeftDoubleBracket]", "k", 
            "\[RightDoubleBracket]"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"p", "=", 
          RowBox[{"CoefficientList", "[", 
           RowBox[{
            RowBox[{"Numerator", "[", "f", "]"}], ",", "\[Sigma]"}], "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"q", "=", 
          RowBox[{"CoefficientList", "[", 
           RowBox[{
            RowBox[{"Denominator", "[", "f", "]"}], ",", "\[Sigma]"}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "q", "]"}], "\[Equal]", "1"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"p", "/=", 
             RowBox[{
             "q", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
            ";", "\[IndentingNewLine]", 
            RowBox[{"q", "/=", 
             RowBox[{
             "q", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
            ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
          "deltas", "\[LeftDoubleBracket]", "k", "\[RightDoubleBracket]"}], 
          "=", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"PadRight", "[", 
             RowBox[{"p", ",", "16"}], "]"}], ",", 
            RowBox[{"PadRight", "[", 
             RowBox[{"q", ",", "16"}], "]"}]}], "}"}]}]}], 
        "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", "10"}], "}"}]}], "]"}], ";", "\[IndentingNewLine]",
       "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "deltas", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]}], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 FontFamily->"DejaVu Sans Mono"]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Calculate scheme coefficients", "Subsubtitle"]], \
"Input",
 Evaluatable->False,
 CellGroupingRules->{GroupTogetherGrouping, 10002.}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SetAttributes", "[", 
   RowBox[{"CalculateSchemes", ",", "HoldRest"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CalculateSchemes", "[", 
    RowBox[{"input_", ",", "C3_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
      "\[Mu]", ",", "\[IndentingNewLine]", "\[Nu]", ",", 
       "\[IndentingNewLine]", "stencil", ",", "courant", ",", 
       "\[IndentingNewLine]", "i", ",", "j", ",", "np", ",", "cs", ",", "sol",
        ",", "eqns"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"stencil", ",", "courant"}], "}"}], "=", "input"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"np", "=", 
       RowBox[{
        RowBox[{"Length", "[", 
         RowBox[{"Flatten", "@", "stencil"}], "]"}], "-", 
        RowBox[{"Count", "[", 
         RowBox[{
          RowBox[{"Flatten", "@", "stencil"}], ",", "False"}], "]"}]}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\[Mu]", ",", "\[Nu]"}], "}"}], "=", 
       RowBox[{"StencilToMuNu", "[", "stencil", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"np", "=", 
       RowBox[{"Length", "@", "\[Mu]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"cs", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Unique", "[", "c", "]"}], ",", 
         RowBox[{"{", "np", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"eqns", "=", 
       RowBox[{"Flatten", "[", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"Total", "[", "cs", "]"}], "\[Equal]", "1"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"\[Mu]", "-", 
                 RowBox[{"\[Sigma]", " ", "\[Nu]"}]}], ")"}], "k"], ".", 
              "cs"}], "\[Equal]", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"-", "\[Sigma]"}], ")"}], "k"]}], ",", 
            RowBox[{"{", 
             RowBox[{"k", ",", 
              RowBox[{"np", "-", "1"}]}], "}"}]}], "]"}]}], 
         "\[IndentingNewLine]", "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"sol", "=", 
       RowBox[{"First", "@", 
        RowBox[{"Solve", "[", 
         RowBox[{"eqns", ",", "cs"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"C3", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"Evaluate", "@", 
           RowBox[{"Simplify", "[", 
            RowBox[{
             RowBox[{"cs", "/.", "sol"}], "/.", 
             RowBox[{"{", 
              RowBox[{"\[Sigma]", "\[Rule]", "#1"}], "}"}]}], "]"}]}], "&"}], 
         ",", "stencil"}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Grid", "[", 
       RowBox[{
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"\"\<Maximum order approximation scheme:\>\"", ",", 
           RowBox[{"CoeffToHuman", "[", "C3", "]"}]}], "}"}], 
         "\[IndentingNewLine]", "}"}], ",", 
        RowBox[{"Alignment", "\[Rule]", "Left"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10002.},
 FontFamily->"DejaVu Sans Mono"]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Inspect scheme properties", "Subsubtitle"]], "Input",
 Evaluatable->False,
 CellGroupingRules->{GroupTogetherGrouping, 10003.},
 FormatType->"TextForm"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SetAttributes", "[", 
   RowBox[{"AnalyzeScheme", ",", "HoldRest"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AnalyzeScheme", "[", 
    RowBox[{"s_", ",", "ss_", ",", "schmlist_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "sol", ",", "\[IndentingNewLine]", "schm", ",", "stencil", ",", 
       "\[IndentingNewLine]", "\[Alpha]", ",", "\[Lambda]", ",", "i", ",", 
       "\[IndentingNewLine]", "\[Mu]", ",", "\[Nu]", ",", "np", ",", 
       "\[IndentingNewLine]", "pattern", ",", "\[Sigma]", ",", "eqn"}], 
      "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"ss", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}],
          "\[Equal]", "Null"}], ",", 
        RowBox[{"Return", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"schm", ",", "stencil"}], "}"}], "=", "ss"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"np", "=", 
       RowBox[{
        RowBox[{"Length", "[", 
         RowBox[{"Flatten", "@", "stencil"}], "]"}], "-", 
        RowBox[{"Count", "[", 
         RowBox[{
          RowBox[{"Flatten", "@", "stencil"}], ",", "False"}], "]"}]}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Quiet", "@", 
            RowBox[{"Length", "[", 
             RowBox[{"schm", "[", "s", "]"}], "]"}]}], "\[NotEqual]", "np"}], 
          ",", 
          RowBox[{"schm", "=", 
           RowBox[{"First", "@", 
            RowBox[{"First", "@", "list"}]}]}]}], "]"}], ";"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\[Mu]", ",", "\[Nu]"}], "}"}], "=", 
       RowBox[{"StencilToMuNu", "[", "stencil", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"eqn", "=", 
       RowBox[{"Collect", "[", 
        RowBox[{
         RowBox[{
          SuperscriptBox["\[Lambda]", "2"], "-", 
          RowBox[{"Total", "[", 
           RowBox[{
            RowBox[{"schm", "[", "s", "]"}], 
            SuperscriptBox["\[Lambda]", 
             RowBox[{"\[Nu]", "+", "1"}]], 
            RowBox[{"Exp", "[", 
             RowBox[{"I", " ", "\[Alpha]", " ", "\[Mu]"}], "]"}]}], "]"}]}], 
         ",", "\[Lambda]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"sol", "=", 
       RowBox[{"Solve", "[", 
        RowBox[{
         RowBox[{"eqn", "\[Equal]", "0"}], ",", 
         RowBox[{"{", "\[Lambda]", "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"pattern", "=", 
       RowBox[{
        RowBox[{"Reap", "[", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"schm", "[", "\[Sigma]", "]"}], "\[LeftDoubleBracket]",
                "i", "\[RightDoubleBracket]"}], "=!=", "0"}], ",", 
             RowBox[{"Sow", "[", "i", "]"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "np"}], "}"}]}], "]"}], "]"}], 
        "\[LeftDoubleBracket]", 
        RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Deploy", "@", 
       RowBox[{"Grid", "[", 
        RowBox[{
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"\"\<\>\"", ",", 
             RowBox[{"With", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"img", "=", "\[IndentingNewLine]", 
                 RowBox[{"Graphics", "[", 
                  RowBox[{
                   RowBox[{"Flatten", "@", 
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Rotate", "[", 
                    RowBox[{
                    RowBox[{"Rectangle", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "2"}], "/", "5"}], ",", 
                    RowBox[{"2", "-", 
                    RowBox[{"2", "/", "5"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"2", "/", "5"}], ",", 
                    RowBox[{"2", "+", 
                    RowBox[{"2", "/", "5"}]}]}], "}"}]}], "]"}], ",", 
                    RowBox[{"45", "Degree"}]}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"Disk", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"2", 
                    RowBox[{
                    "\[Mu]", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}]}], ",", 
                    RowBox[{"2", 
                    RowBox[{
                    "\[Nu]", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}]}]}], "}"}], ",", 
                    RowBox[{"1", "/", "2"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "np"}], "}"}]}], "]"}]}], 
                    "\[IndentingNewLine]", "}"}]}], ",", 
                   RowBox[{"PlotRange", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "5"}], ",", "5"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "3"}], ",", "3"}], "}"}]}], "}"}]}]}], 
                  "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Button", "[", 
                RowBox[{"\"\<Add to list\>\"", ",", 
                 RowBox[{"schmlist", "=", 
                  RowBox[{"Append", "[", 
                   RowBox[{"schmlist", ",", 
                    RowBox[{"ss", "\[Rule]", "img"}]}], "]"}]}]}], "]"}]}], 
              "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"\"\<Scheme:\>\"", ",", 
             RowBox[{"CoeffToHuman", "[", "ss", "]"}]}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"\"\<Stencil: \>\"", ",", 
             RowBox[{"Graphics", "[", 
              RowBox[{
               RowBox[{"Flatten", "@", 
                RowBox[{"{", "\[IndentingNewLine]", 
                 RowBox[{"Red", ",", "Thick", ",", "Dashed", ",", 
                  RowBox[{"Line", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "2"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "4"}], "s"}], ",", 
                    RowBox[{"-", "2"}]}], "}"}]}], "}"}], "]"}], ",", 
                  "\[IndentingNewLine]", "Black", ",", "Thin", ",", 
                  RowBox[{"Dashing", "[", 
                   RowBox[{"{", "\[Infinity]", "}"}], "]"}], ",", 
                  RowBox[{"Rotate", "[", 
                   RowBox[{
                    RowBox[{"Rectangle", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "2"}], "/", "5"}], ",", 
                    RowBox[{"2", "-", 
                    RowBox[{"2", "/", "5"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"2", "/", "5"}], ",", 
                    RowBox[{"2", "+", 
                    RowBox[{"2", "/", "5"}]}]}], "}"}]}], "]"}], ",", 
                    RowBox[{"45", "Degree"}]}], "]"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"Table", "[", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"schm", "[", "\[Sigma]", "]"}], 
                    "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], "===",
                     "0"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Circle", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"2", 
                    RowBox[{
                    "\[Mu]", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}]}], ",", 
                    RowBox[{"2", 
                    RowBox[{
                    "\[Nu]", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}]}]}], "}"}], ",", 
                    RowBox[{"1", "/", "2"}]}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Disk", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"2", 
                    RowBox[{
                    "\[Mu]", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}]}], ",", 
                    RowBox[{"2", 
                    RowBox[{
                    "\[Nu]", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}]}]}], "}"}], ",", 
                    RowBox[{"1", "/", "2"}]}], "]"}]}], "]"}], 
                    "\[IndentingNewLine]", ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "np"}], "}"}]}], "]"}]}], 
                 "\[IndentingNewLine]", "}"}]}], ",", 
               RowBox[{"PlotRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", "5"}], ",", "5"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", "3"}], ",", "3"}], "}"}]}], "}"}]}]}], 
              "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"\"\<Flat stencil: \>\"", ",", 
             RowBox[{"Graphics", "[", 
              RowBox[{
               RowBox[{"Flatten", "@", 
                RowBox[{"{", "\[IndentingNewLine]", 
                 RowBox[{"Red", ",", "Thick", ",", "Dashed", ",", 
                  RowBox[{"Line", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "2"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "4"}], "s"}], ",", 
                    RowBox[{"-", "2"}]}], "}"}]}], "}"}], "]"}], ",", 
                  "\[IndentingNewLine]", "Black", ",", "Thin", ",", 
                  RowBox[{"Dashing", "[", 
                   RowBox[{"{", "\[Infinity]", "}"}], "]"}], ",", 
                  RowBox[{"Rotate", "[", 
                   RowBox[{
                    RowBox[{"Rectangle", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "2"}], "/", "5"}], ",", 
                    RowBox[{"2", "-", 
                    RowBox[{"2", "/", "5"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"2", "/", "5"}], ",", 
                    RowBox[{"2", "+", 
                    RowBox[{"2", "/", "5"}]}]}], "}"}]}], "]"}], ",", 
                    RowBox[{"45", "Degree"}]}], "]"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"Table", "[", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"Gray", ",", 
                    RowBox[{"Line", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"2", 
                    RowBox[{
                    "\[Mu]", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}]}], ",", 
                    RowBox[{"2", " ", 
                    RowBox[{
                    "\[Nu]", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"2", 
                    RowBox[{
                    "\[Mu]", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}]}], "-", 
                    RowBox[{"2", "s", " ", 
                    RowBox[{
                    "\[Nu]", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}]}]}], ",", "0"}], "}"}]}], "}"}],
                     "]"}]}], "}"}], "\[IndentingNewLine]", ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "np"}], "}"}]}], "]"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"Table", "[", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"schm", "[", "\[Sigma]", "]"}], 
                    "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], "===",
                     "0"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"Gray", ",", 
                    RowBox[{"Circle", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"2", 
                    RowBox[{
                    "\[Mu]", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}]}], ",", 
                    RowBox[{"2", " ", 
                    RowBox[{
                    "\[Nu]", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}]}]}], "}"}], ",", 
                    RowBox[{"1", "/", "2"}]}], "]"}]}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"Gray", ",", 
                    RowBox[{"Disk", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"2", 
                    RowBox[{
                    "\[Mu]", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}]}], ",", 
                    RowBox[{"2", 
                    RowBox[{
                    "\[Nu]", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}]}]}], "}"}], ",", 
                    RowBox[{"1", "/", "2"}]}], "]"}]}], "}"}]}], "]"}], 
                    "\[IndentingNewLine]", ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "np"}], "}"}]}], "]"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"Table", "[", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"schm", "[", "\[Sigma]", "]"}], 
                    "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], "===",
                     "0"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"Black", ",", 
                    RowBox[{"Circle", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"2", 
                    RowBox[{
                    "\[Mu]", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}]}], "-", 
                    RowBox[{"2", "s", " ", 
                    RowBox[{
                    "\[Nu]", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}]}]}], ",", "0"}], "}"}], ",", 
                    RowBox[{"1", "/", "2"}]}], "]"}]}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"Black", ",", 
                    RowBox[{"Disk", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"2", 
                    RowBox[{
                    "\[Mu]", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}]}], "-", 
                    RowBox[{"2", "s", " ", 
                    RowBox[{
                    "\[Nu]", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}]}]}], ",", "0"}], "}"}], ",", 
                    RowBox[{"1", "/", "2"}]}], "]"}]}], "}"}]}], "]"}], 
                    "\[IndentingNewLine]", ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "np"}], "}"}]}], "]"}]}], 
                 "\[IndentingNewLine]", "}"}]}], ",", 
               RowBox[{"PlotRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", "5"}], ",", "5"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", "3"}], ",", "3"}], "}"}]}], "}"}]}]}], 
              "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"\"\<Monotonicity: \>\"", ",", 
             RowBox[{
              RowBox[{
               RowBox[{"Reduce", "[", 
                RowBox[{"And", "@@", 
                 RowBox[{"Table", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"schm", "[", "\[Sigma]", "]"}], 
                    "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
                    "\[GreaterEqual]", "0"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"i", ",", "np"}], "}"}]}], "]"}]}], "]"}], "/.", 
               RowBox[{"\[Sigma]", "\[Rule]", "\"\<\[Sigma]\>\""}]}], "/.", 
              RowBox[{"False", "\[Rule]", "\"\<Never\>\""}]}]}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
            "\"\<Stability over spectrum (|\[Lambda](\[Alpha])|): \>\"", " ", 
             ",", "\[IndentingNewLine]", 
             RowBox[{"PolarPlot", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"1.01", ",", 
                 RowBox[{
                  RowBox[{
                   SuperscriptBox["10", 
                    RowBox[{"-", "2"}]], "+", 
                   RowBox[{"Abs", "[", "\[Lambda]", "]"}]}], "/.", 
                  RowBox[{
                  "sol", "\[LeftDoubleBracket]", "1", 
                   "\[RightDoubleBracket]"}]}], ",", 
                 RowBox[{
                  RowBox[{
                   SuperscriptBox["10", 
                    RowBox[{"-", "2"}]], "+", 
                   RowBox[{"Abs", "[", "\[Lambda]", "]"}]}], "/.", 
                  RowBox[{"sol", "\[LeftDoubleBracket]", 
                   RowBox[{"-", "1"}], "\[RightDoubleBracket]"}]}]}], "}"}], 
               ",", 
               RowBox[{"{", 
                RowBox[{"\[Alpha]", ",", "0", ",", 
                 RowBox[{"2", "\[Pi]"}]}], "}"}], ",", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Directive", "[", 
                   RowBox[{"Dashed", ",", "Black"}], "]"}], ",", "Red", ",", 
                  "Blue"}], "}"}]}], ",", 
               RowBox[{"PlotRange", "\[Rule]", "1.2"}], ",", 
               RowBox[{"ImageSize", "\[Rule]", "450"}]}], "]"}]}], 
            "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
            "\"\<Phase offset (Arg \[Lambda](\[Alpha]) + \[Alpha]\[Sigma]): \
\>\"", " ", ",", "\[IndentingNewLine]", 
             RowBox[{"Plot", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"\[Alpha]", " ", "s"}], "+", 
                   RowBox[{"Arg", "[", "\[Lambda]", "]"}]}], "/.", 
                  RowBox[{
                  "sol", "\[LeftDoubleBracket]", "1", 
                   "\[RightDoubleBracket]"}]}], ",", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"\[Alpha]", " ", "s"}], "+", 
                   RowBox[{"Arg", "[", "\[Lambda]", "]"}]}], "/.", 
                  RowBox[{"sol", "\[LeftDoubleBracket]", 
                   RowBox[{"-", "1"}], "\[RightDoubleBracket]"}]}]}], "}"}], 
               ",", 
               RowBox[{"{", 
                RowBox[{"\[Alpha]", ",", "0", ",", "\[Pi]"}], "}"}], ",", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{"Red", ",", "Blue"}], "}"}]}], ",", 
               RowBox[{"ImageSize", "\[Rule]", "450"}]}], "]"}]}], 
            "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", "}"}], ",", 
         RowBox[{"Alignment", "\[Rule]", "Center"}]}], "]"}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10003.},
 FontFamily->"DejaVu Sans Mono"]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["User interface utilities", "Subsubtitle"]], "Input",
 Evaluatable->False,
 CellGroupingRules->{GroupTogetherGrouping, 10004.}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SetAttributes", "[", 
   RowBox[{"StepsBox", ",", "HoldRest"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"StepsBox", "[", 
    RowBox[{
    "xtrange_", ",", "M_", ",", "h_", ",", "\[Sigma]_", ",", "\[Tau]_", ",", 
     "T_"}], "]"}], ":=", 
   RowBox[{"DynamicModule", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x0", ",", "x1", ",", 
       RowBox[{"Courant", "=", "True"}], ",", "ToNearestRound", ",", "rounds",
        ",", "\[IndentingNewLine]", "MToh", ",", "hToM"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"x0", ",", "x1"}], "}"}], "=", "xtrange"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"rounds", "=", 
       RowBox[{"Sort", "@", 
        RowBox[{"DeleteDuplicates", "@", 
         RowBox[{"Flatten", "@", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"10", "i"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "10"}], "}"}]}], "]"}], ",", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"25", "i"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "8"}], "}"}]}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"50", "i"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "10"}], "}"}]}], "]"}], ",", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"100", "i"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "10"}], "}"}]}], "]"}], ",", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"250", "i"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "4"}], "}"}]}], "]"}]}], 
           "\[IndentingNewLine]", "}"}]}]}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ToNearestRound", "[", "f_", "]"}], ":=", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"minposv", ",", "maxnegv"}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"minposv", "=", 
           RowBox[{"Min", "[", 
            RowBox[{"Select", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"f", "/", "rounds"}], "-", "1"}], ",", 
              RowBox[{
               RowBox[{"0", "\[LessEqual]", "#"}], "&"}]}], "]"}], "]"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"maxnegv", "=", 
           RowBox[{"Max", "[", 
            RowBox[{"Select", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"f", "/", "rounds"}], "-", "1"}], ",", 
              RowBox[{
               RowBox[{"0", "\[GreaterEqual]", "#"}], "&"}]}], "]"}], "]"}]}],
           ";", "\[IndentingNewLine]", 
          RowBox[{"Round", "@", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"minposv", "<", 
              RowBox[{"-", "maxnegv"}]}], ",", 
             RowBox[{"f", "/", 
              RowBox[{"(", 
               RowBox[{"minposv", "+", "1"}], ")"}]}], ",", 
             RowBox[{"f", "/", 
              RowBox[{"(", 
               RowBox[{"1", "+", "maxnegv"}], ")"}]}]}], "]"}]}]}]}], 
        "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"MToh", "[", "eM_", "]"}], ":=", 
       RowBox[{"N", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"x1", "-", "x0"}], ")"}], "/", 
         RowBox[{"(", "eM", ")"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"hToM", "[", "aisH_", "]"}], ":=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"x1", "-", "x0"}], ")"}], "/", "aisH"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Panel", "@", 
       RowBox[{"Deploy", "@", 
        RowBox[{"Grid", "[", 
         RowBox[{
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
             "\"\<M, points number\>\"", ",", "Null", ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Slider", "[", 
               RowBox[{
                RowBox[{"Dynamic", "[", 
                 RowBox[{"M", ",", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"M", "=", 
                    RowBox[{"ToNearestRound", "[", "#", "]"}]}], ";", 
                    RowBox[{"h", "=", 
                    RowBox[{"MToh", "[", "M", "]"}]}], ";", 
                    RowBox[{"If", "[", 
                    RowBox[{"Courant", ",", 
                    RowBox[{"\[Tau]", "=", 
                    RowBox[{"\[Sigma]", " ", "h"}]}], ",", 
                    RowBox[{"\[Sigma]", "=", 
                    RowBox[{"\[Tau]", "/", "h"}]}]}], "]"}]}], ")"}], "&"}]}],
                  "]"}], ",", 
                RowBox[{"{", "rounds", "}"}], ",", "\[IndentingNewLine]", 
                RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}]}], 
               "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{
             "\"\<h, spatial step\>\"", ",", "Null", ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Slider", "[", 
               RowBox[{
                RowBox[{"Dynamic", "[", 
                 RowBox[{"h", ",", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"M", "=", 
                    RowBox[{"ToNearestRound", "[", 
                    RowBox[{"hToM", "[", "#", "]"}], "]"}]}], ";", 
                    RowBox[{"h", "=", 
                    RowBox[{"MToh", "[", "M", "]"}]}], ";", 
                    RowBox[{"If", "[", 
                    RowBox[{"Courant", ",", 
                    RowBox[{"\[Tau]", "=", 
                    RowBox[{"\[Sigma]", " ", "h"}]}], ",", 
                    RowBox[{"\[Sigma]", "=", 
                    RowBox[{"\[Tau]", "/", "h"}]}]}], "]"}]}], ")"}], "&"}]}],
                  "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"Reverse", "[", 
                  RowBox[{"MToh", "[", "rounds", "]"}], "]"}], "}"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}]}], 
               "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{
             "\"\<\[Sigma]=\!\(\*FractionBox[\(\(|\)\(\[Lambda]\)\*\
SubscriptBox[\(|\), \(max\)]\(\[Tau]\)\), \(h\)]\), Courant number\>\"", ",", 
              
              RowBox[{"RadioButton", "[", 
               RowBox[{
                RowBox[{"Dynamic", "[", "Courant", "]"}], ",", "True"}], 
               "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{"Slider", "[", 
               RowBox[{
                RowBox[{"Dynamic", "[", 
                 RowBox[{"\[Sigma]", ",", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Sigma]", "=", 
                    RowBox[{"Max", "[", 
                    RowBox[{"#", ",", "0.01"}], "]"}]}], ";", 
                    RowBox[{"\[Tau]", "=", 
                    RowBox[{"\[Sigma]", " ", "h"}]}]}], ")"}], "&"}]}], "]"}],
                 ",", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "2", ",", ".01"}], "}"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", 
                RowBox[{"Enabled", "\[Rule]", 
                 RowBox[{"Dynamic", "[", "Courant", "]"}]}]}], "]"}]}], "}"}],
             ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{
             "\"\<|\[Lambda]\!\(\*SubscriptBox[\(|\), \(max\)]\)\[Tau], time \
step\>\"", ",", 
              RowBox[{"RadioButton", "[", 
               RowBox[{
                RowBox[{"Dynamic", "[", "Courant", "]"}], ",", "False"}], 
               "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{"Slider", "[", 
               RowBox[{
                RowBox[{"Dynamic", "[", 
                 RowBox[{"\[Tau]", ",", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Tau]", "=", 
                    RowBox[{"Max", "[", 
                    RowBox[{"#", ",", "0.001"}], "]"}]}], ";", 
                    RowBox[{"\[Sigma]", "=", 
                    RowBox[{"\[Tau]", "/", "h"}]}]}], ")"}], "&"}]}], "]"}], 
                ",", "\[IndentingNewLine]", 
                RowBox[{"{", 
                 RowBox[{"0.001", ",", "0.2"}], "}"}], ",", 
                RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", 
                RowBox[{"Enabled", "\[Rule]", 
                 RowBox[{"Dynamic", "[", 
                  RowBox[{"!", "Courant"}], "]"}]}]}], "]"}]}], "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{
             "\"\<T, max time\>\"", ",", "Null", ",", "\[IndentingNewLine]", 
              RowBox[{"Slider", "[", 
               RowBox[{
                RowBox[{"Dynamic", "[", "T", "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"0.1", ",", "10"}], "}"}], ",", 
                RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}]}], 
               "]"}]}], "}"}]}], "\[IndentingNewLine]", "}"}], ",", 
          RowBox[{"Alignment", "\[Rule]", "Left"}]}], "]"}]}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetAttributes", "[", 
   RowBox[{"ProblemBox", ",", "HoldAll"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ProblemBox", "[", 
    RowBox[{
    "problem_", ",", "\[Rho]L_", ",", "uL_", ",", "\[CurlyEpsilon]L_", ",", 
     "\[Rho]R_", ",", "uR_", ",", "\[CurlyEpsilon]R_"}], "]"}], ":=", 
   RowBox[{"DynamicModule", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x0", ",", "x1", ",", "t0", ",", "t1", ",", 
       RowBox[{"Courant", "=", "True"}], ",", "ToNearestRound", ",", "rounds",
        ",", "\[IndentingNewLine]", "MToh", ",", "hToM"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Panel", "@", 
      RowBox[{"Deploy", "@", 
       RowBox[{"Grid", "[", 
        RowBox[{
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"\"\<Problem type\>\"", ",", 
             RowBox[{"RadioButtonBar", "[", 
              RowBox[{
               RowBox[{"Dynamic", "[", "problem", "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"\"\<Contact\>\"", ",", "\"\<Riemann\>\""}], "}"}]}], 
              "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"\"\<Foo\>\"", ",", "\"\<Bar\>\""}], "}"}]}], 
          "\[IndentingNewLine]", "}"}], ",", 
         RowBox[{"Alignment", "\[Rule]", "Left"}]}], "]"}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetAttributes", "[", 
   RowBox[{"StencilBox", ",", "HoldAll"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"StencilBox", "[", 
    RowBox[{"stencil_", ",", "localStencil_", ",", "\[Sigma]_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "StencilPoint", ",", "GrayPoint", ",", "Checker", ",", 
       "GetFreeNumber"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"GetFreeNumber", "[", "]"}], ":=", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"used", ",", "notused"}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"used", "=", 
           RowBox[{"Complement", "[", 
            RowBox[{
             RowBox[{"Flatten", "@", "localStencil"}], ",", 
             RowBox[{"{", "False", "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"notused", "=", 
           RowBox[{"Complement", "[", 
            RowBox[{
             RowBox[{"Range", "[", "13", "]"}], ",", "used"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Min", "@", "notused"}]}]}], "\[IndentingNewLine]", "]"}]}],
       ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"StencilPoint", "[", 
        RowBox[{"Dynamic", "[", "x_", "]"}], "]"}], ":=", 
       "\[IndentingNewLine]", 
       RowBox[{"EventHandler", "[", 
        RowBox[{
         RowBox[{"Dynamic", "[", 
          RowBox[{"x", "/.", 
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"False", "\[Rule]", 
              RowBox[{"Deploy", "[", 
               RowBox[{"Graphics", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"Circle", "[", "]"}], "}"}], ",", 
                 RowBox[{"ImageSize", "\[Rule]", "20"}]}], "]"}], "]"}]}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{"j_Integer", "\[RuleDelayed]", 
              RowBox[{"Deploy", "@", 
               RowBox[{"Graphics", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Disk", "[", "]"}], ",", 
                   RowBox[{"Text", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", "j", "]"}], ",", "Medium", ",", 
                    "Bold", ",", "White"}], "]"}], ",", 
                    RowBox[{"FormatType", "\[Rule]", "StandardForm"}]}], 
                    "]"}]}], "}"}], ",", 
                 RowBox[{"ImageSize", "\[Rule]", "20"}]}], "]"}]}]}]}], 
            "}"}]}], "\[IndentingNewLine]", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"\"\<MouseClicked\>\"", "\[RuleDelayed]", 
           RowBox[{"{", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"TrueQ", "[", 
               RowBox[{"!", "x"}], "]"}], ",", 
              RowBox[{"x", "=", 
               RowBox[{"GetFreeNumber", "[", "]"}]}], ",", 
              RowBox[{"x", "=", "False"}]}], "]"}], "}"}]}], "}"}]}], "]"}]}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"GrayPoint", "=", 
       RowBox[{"Deploy", "[", 
        RowBox[{"Graphics", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"Rotate", "[", 
            RowBox[{
             RowBox[{"Rectangle", "[", "]"}], ",", 
             RowBox[{"45", "Degree"}]}], "]"}], "}"}], ",", 
          RowBox[{"ImageSize", "\[Rule]", "20"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Checker", ":=", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"v", "=", "True"}], ",", "conv"}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"conv", "=", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"UnsameQ", "[", 
                 RowBox[{"False", ",", "#"}], "]"}], ",", "#", ",", "0"}], 
               "]"}], "&"}], ",", 
             RowBox[{"Flatten", "[", "localStencil", "]"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Do", "[", 
           RowBox[{
            RowBox[{"v", "=", 
             RowBox[{"And", "[", 
              RowBox[{"v", ",", 
               RowBox[{"1", "\[Equal]", 
                RowBox[{"Count", "[", 
                 RowBox[{"conv", ",", "j"}], "]"}]}]}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "1", ",", 
              RowBox[{"Max", "@", "conv"}]}], "}"}]}], "]"}], ";", 
          "\[IndentingNewLine]", "v"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Panel", "[", 
       RowBox[{"Deploy", "@", 
        RowBox[{"Column", "[", 
         RowBox[{
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Row", "@", 
             RowBox[{"{", "\"\<Stencil\>\"", "}"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Row", "@", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"StencilPoint", "[", 
                RowBox[{"Dynamic", "@", 
                 RowBox[{"localStencil", "\[LeftDoubleBracket]", 
                  RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}]}], "]"}],
                ",", "GrayPoint", ",", 
               RowBox[{"StencilPoint", "[", 
                RowBox[{"Dynamic", "@", 
                 RowBox[{"localStencil", "\[LeftDoubleBracket]", 
                  RowBox[{"1", ",", "4"}], "\[RightDoubleBracket]"}]}], 
                "]"}]}], "}"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"Row", "@", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"StencilPoint", "[", 
                RowBox[{"With", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"i", "=", "i"}], "}"}], ",", 
                  RowBox[{"Dynamic", "@", 
                   RowBox[{"localStencil", "\[LeftDoubleBracket]", 
                    RowBox[{"2", ",", "i"}], "\[RightDoubleBracket]"}]}]}], 
                 "]"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "5"}], "}"}]}], "]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Row", "@", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"StencilPoint", "[", 
                RowBox[{"With", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"i", "=", "i"}], "}"}], ",", 
                  RowBox[{"Dynamic", "@", 
                   RowBox[{"localStencil", "\[LeftDoubleBracket]", 
                    RowBox[{"3", ",", "i"}], "\[RightDoubleBracket]"}]}]}], 
                 "]"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "5"}], "}"}]}], "]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Row", "@", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Spacer", "[", "50", "]"}], ",", 
               RowBox[{"Dynamic", "@", 
                RowBox[{"If", "[", 
                 RowBox[{"Checker", ",", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"stencil", "=", "localStencil"}], ";", 
                   RowBox[{"Framed", "[", 
                    RowBox[{"\"\<OK\>\"", ",", 
                    RowBox[{"Background", "\[Rule]", "Green"}]}], "]"}]}], 
                  ",", "\[IndentingNewLine]", 
                  RowBox[{"Framed", "[", 
                   RowBox[{"\"\<Bad\>\"", ",", 
                    RowBox[{"Background", "\[Rule]", "Red"}]}], "]"}]}], 
                 "]"}]}]}], "}"}]}]}], "\[IndentingNewLine]", "}"}], ",", 
          RowBox[{"Alignment", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"Center", ",", "Top"}], "}"}]}]}], "]"}]}], 
       "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DiagramPU", "[", "]"}], ":=", 
   RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "pL", ",", "pR", ",", "cL", ",", "cR", ",", "\[Chi]", ",", "Ps", ",", 
         "Us", ",", "umin", ",", "umax", ",", "\[CapitalDelta]", ",", "F", 
         ",", "dFdP", ",", "G", ",", "dGdP"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\[Chi]", "=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"\[Gamma]", "-", "1"}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{"2", " ", "\[Gamma]"}], ")"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"pL", ",", "pR"}], "}"}], "=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"\[Gamma]", "-", "1"}], ")"}], " ", 
          RowBox[{"{", 
           RowBox[{"\[Rho]L", ",", "\[Rho]R"}], "}"}], "*", 
          RowBox[{"{", 
           RowBox[{"\[CurlyEpsilon]L", ",", "\[CurlyEpsilon]R"}], "}"}]}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"cL", ",", "cR"}], "}"}], "=", 
         SqrtBox[
          RowBox[{"(", 
           RowBox[{"\[Gamma]", " ", 
            RowBox[{"(", 
             RowBox[{"\[Gamma]", "-", "1"}], ")"}], " ", 
            RowBox[{"{", 
             RowBox[{"\[CurlyEpsilon]L", ",", "\[CurlyEpsilon]R"}], "}"}]}], 
           ")"}]]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"F", "[", 
          RowBox[{"p_", ",", "c_", ",", "\[Rho]_", ",", "P_"}], "]"}], ":=", 
         RowBox[{"Piecewise", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               FractionBox[
                RowBox[{"2", " ", "c"}], 
                RowBox[{"\[Gamma]", "-", "1"}]], 
               RowBox[{"(", 
                RowBox[{
                 SuperscriptBox[
                  RowBox[{"(", 
                   FractionBox["P", "p"], ")"}], "\[Chi]"], "-", "1"}], 
                ")"}]}], ",", 
              RowBox[{"P", "<", "p"}]}], "}"}], "}"}], ",", 
           FractionBox[
            RowBox[{"P", "-", "p"}], 
            SqrtBox[
             RowBox[{
              FractionBox["\[Rho]", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"P", " ", 
                 RowBox[{"(", 
                  RowBox[{"\[Gamma]", "+", "1"}], ")"}]}], "+", 
                RowBox[{"p", " ", 
                 RowBox[{"(", 
                  RowBox[{"\[Gamma]", "-", "1"}], ")"}]}]}], ")"}]}]]]}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"dFdP", "[", 
          RowBox[{"p_", ",", "c_", ",", "\[Rho]_", ",", "P_"}], "]"}], ":=", 
         RowBox[{"Piecewise", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"-", 
                FractionBox[
                 RowBox[{"2", "c", " ", "\[Chi]"}], 
                 RowBox[{"P", 
                  RowBox[{"(", 
                   RowBox[{"1", "-", "\[Gamma]"}], ")"}]}]]}], 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"P", "/", "p"}], ")"}], "\[Chi]"]}], ",", 
              RowBox[{"p", ">", "P"}]}], "}"}], "}"}], ",", 
           FractionBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"P", "-", "p", "+", 
                RowBox[{"3", "p", " ", "\[Gamma]"}], "+", 
                RowBox[{"P", " ", "\[Gamma]"}]}], ")"}], "\[Rho]"}], ")"}], 
            RowBox[{
             SqrtBox["2"], 
             SuperscriptBox[
              RowBox[{"(", 
               SqrtBox[
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"p", 
                    RowBox[{"(", 
                    RowBox[{"\[Gamma]", "-", "1"}], ")"}]}], "+", 
                   RowBox[{"P", 
                    RowBox[{"(", 
                    RowBox[{"1", "+", "\[Gamma]"}], ")"}]}]}], ")"}], 
                 "\[Rho]"}]], ")"}], "3"]}]]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"G", "[", "Ps_", "]"}], ":=", 
         RowBox[{"uR", "-", "uL", "+", 
          RowBox[{"F", "[", 
           RowBox[{"pR", ",", "cR", ",", "\[Rho]R", ",", "Ps"}], "]"}], "+", 
          RowBox[{"F", "[", 
           RowBox[{"pL", ",", "cL", ",", "\[Rho]L", ",", "Ps"}], "]"}]}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"dGdP", "[", "Ps_", "]"}], ":=", 
         RowBox[{
          RowBox[{"dFdP", "[", 
           RowBox[{"pR", ",", "cR", ",", "\[Rho]R", ",", "Ps"}], "]"}], "+", 
          RowBox[{"dFdP", "[", 
           RowBox[{"pL", ",", "cL", ",", "\[Rho]L", ",", "Ps"}], "]"}]}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"Ps", "=", 
         RowBox[{"Min", "[", 
          RowBox[{"pL", ",", "pR"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"G", "[", "0", "]"}], ">", "0"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Ps", "=", "0"}], ";", "\[IndentingNewLine]", 
           RowBox[{"Us", "=", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"uL", "+", "uR"}], ")"}], "/", "2"}]}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"While", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"G", "[", "Ps", "]"}], ">", "0"}], ",", 
             RowBox[{"Ps", "/=", "2"}]}], "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"Do", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Ps", "-=", 
              RowBox[{
               RowBox[{"G", "[", "Ps", "]"}], "/", 
               RowBox[{"dGdP", "[", "Ps", "]"}]}]}], "\[IndentingNewLine]", 
             ",", 
             RowBox[{"{", 
              RowBox[{"it", ",", "5"}], "}"}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Us", "=", 
            RowBox[{"uR", "+", 
             RowBox[{"F", "[", 
              RowBox[{"pR", ",", "cR", ",", "\[Rho]R", ",", "Ps"}], "]"}]}]}],
            ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"umin", "=", 
         RowBox[{"Min", "[", 
          RowBox[{"uL", ",", "uR", ",", "Us"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"umax", "=", 
         RowBox[{"Max", "[", 
          RowBox[{"uL", ",", "uR", ",", "Us"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"\[CapitalDelta]", "=", 
         RowBox[{"umax", "-", "umin"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"umin", "-=", 
         RowBox[{
          RowBox[{"0.2", " ", "\[CapitalDelta]"}], "+", "0.5"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"umax", "+=", 
         RowBox[{
          RowBox[{"0.2", " ", "\[CapitalDelta]"}], "+", "0.5"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Show", "[", 
         RowBox[{
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"ParametricPlot", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"uR", "+", 
                   RowBox[{"F", "[", 
                    RowBox[{"pR", ",", "cR", ",", "\[Rho]R", ",", "P"}], 
                    "]"}]}], ",", "P"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"uL", "-", 
                   RowBox[{"F", "[", 
                    RowBox[{"pL", ",", "cL", ",", "\[Rho]L", ",", "P"}], 
                    "]"}]}], ",", "P"}], "}"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"P", ",", "0", ",", 
                RowBox[{"1.1", " ", 
                 RowBox[{"Max", "[", 
                  RowBox[{"pL", ",", "pR", ",", "Ps"}], "]"}]}]}], "}"}], ",", 
              RowBox[{"PlotRange", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"umin", ",", "umax"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", 
                   RowBox[{"1.1", " ", 
                    RowBox[{"Max", "[", 
                    RowBox[{"pL", ",", "pR", ",", "Ps"}], "]"}]}]}], "}"}]}], 
                "}"}]}], ",", "\[IndentingNewLine]", 
              RowBox[{"PlotStyle", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Directive", "[", 
                  RowBox[{"Thick", ",", "Red"}], "]"}], ",", 
                 RowBox[{"Directive", "[", 
                  RowBox[{"Thick", ",", "Blue"}], "]"}]}], "}"}]}]}], "]"}], 
            ",", 
            RowBox[{"ListPlot", "[", 
             RowBox[{
              RowBox[{"{", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"Labeled", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"uR", ",", "pR"}], "}"}], ",", 
                   RowBox[{"Style", "[", 
                    RowBox[{"\"\<R\>\"", ",", "Large", ",", "Red"}], "]"}], 
                   ",", "Bottom"}], "]"}], "}"}], ",", "\[IndentingNewLine]", 
                
                RowBox[{"{", 
                 RowBox[{"Labeled", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"uL", ",", "pL"}], "}"}], ",", 
                   RowBox[{"Style", "[", 
                    RowBox[{"\"\<L\>\"", ",", "Large", ",", "Blue"}], "]"}], 
                   ",", "Top"}], "]"}], "}"}], ",", "\[IndentingNewLine]", 
                RowBox[{"{", 
                 RowBox[{"Labeled", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"Us", ",", "Ps"}], "}"}], ",", 
                   RowBox[{"Style", "[", 
                    RowBox[{"\"\<C\>\"", ",", "Large", ",", "Black"}], "]"}], 
                   ",", "Top"}], "]"}], "}"}]}], "}"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"PlotRange", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"umin", ",", "umax"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", 
                   RowBox[{"1.1", " ", 
                    RowBox[{"Max", "[", 
                    RowBox[{"pL", ",", "pR", ",", "Ps"}], "]"}]}]}], "}"}]}], 
                "}"}]}], ",", "\[IndentingNewLine]", 
              RowBox[{"PlotMarkers", "\[Rule]", 
               RowBox[{"Style", "[", 
                RowBox[{"\[Bullet]", ",", "Large"}], "]"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"PlotStyle", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"Red", ",", "Blue", ",", "Black"}], "}"}]}]}], 
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"AxesLabel", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Style", "[", 
              RowBox[{"\"\<u\>\"", ",", "Large"}], "]"}], ",", 
             RowBox[{"Style", "[", 
              RowBox[{"\"\<p\>\"", ",", "Large"}], "]"}]}], "}"}]}], ",", 
          RowBox[{"AspectRatio", "\[Rule]", 
           RowBox[{"2", "/", "3"}]}], ",", 
          RowBox[{"ImageSize", "\[Rule]", "600"}]}], "]"}]}]}], "]"}], "\n", 
     ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "\[Gamma]", ",", "1.4", ",", "\"\<\[Gamma], Cp/Cv ratio\>\""}], "}"}],
        ",", "1.05", ",", "3", ",", 
       RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", 
       RowBox[{"ControlType", "\[Rule]", "Slider"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "\[Rho]L", ",", "1.", ",", 
         "\"\<\!\(\*SubscriptBox[\(\[Rho]\), \(left\)]\)\>\""}], "}"}], ",", 
       "0.01", ",", "3", ",", 
       RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", 
       RowBox[{"ControlType", "\[Rule]", "Slider"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "uL", ",", "1.", ",", 
         "\"\<\!\(\*SubscriptBox[\(u\), \(left\)]\)\>\""}], "}"}], ",", 
       RowBox[{"-", "3"}], ",", "3", ",", 
       RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", 
       RowBox[{"ControlType", "\[Rule]", "Slider"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "\[CurlyEpsilon]L", ",", "2.5", ",", 
         "\"\<\!\(\*SubscriptBox[\(\[CurlyEpsilon]\), \(left\)]\)\>\""}], 
        "}"}], ",", "0.01", ",", "5", ",", 
       RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", 
       RowBox[{"ControlType", "\[Rule]", "Slider"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "\[Rho]R", ",", ".5", ",", 
         "\"\<\!\(\*SubscriptBox[\(\[Rho]\), \(right\)]\)\>\""}], "}"}], ",", 
       "0.01", ",", "3", ",", 
       RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", 
       RowBox[{"ControlType", "\[Rule]", "Slider"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "uR", ",", "1.", ",", 
         "\"\<\!\(\*SubscriptBox[\(u\), \(right\)]\)\>\""}], "}"}], ",", 
       RowBox[{"-", "3"}], ",", "3", ",", 
       RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", 
       RowBox[{"ControlType", "\[Rule]", "Slider"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "\[CurlyEpsilon]R", ",", "5.", ",", 
         "\"\<\!\(\*SubscriptBox[\(\[CurlyEpsilon]\), \(right\)]\)\>\""}], 
        "}"}], ",", "0.01", ",", "5", ",", 
       RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", 
       RowBox[{"ControlType", "\[Rule]", "Slider"}]}], "}"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10004.},
 FontFamily->"DejaVu Sans Mono"]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Solver interfaces", "Subsubtitle"]], "Input",
 Evaluatable->False,
 CellGroupingRules->{GroupTogetherGrouping, 10005.}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SetAttributes", "[", 
   RowBox[{"Solver", ",", "HoldAll"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Solver", "[", 
    RowBox[{
    "schm1_", ",", "schm2_", ",", "schm3_", ",", "schm4_", ",", "list_", ",", 
     "M_", ",", "\[Sigma]_", ",", "\[IndentingNewLine]", "solver_", ",", 
     "problem_", ",", "T_", ",", "\[Gamma]_", ",", "\[Rho]L_", ",", "uL_", 
     ",", "\[CurlyEpsilon]L_", ",", "\[Rho]R_", ",", "uR_", ",", 
     "\[CurlyEpsilon]R_", ",", "\[IndentingNewLine]", "progress_", ",", 
     "iprint_", ",", "sol_", ",", "frame_", ",", "time_", ",", "steps_"}], 
    "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"DynamicModule", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"running", "=", "False"}], ",", "dt", ",", 
       "\[IndentingNewLine]", "deltas1", ",", "deltas2", ",", "deltas3", ",", 
       "deltas4", ",", "\[IndentingNewLine]", "\[Rho]", ",", "u", ",", 
       "\[CurlyEpsilon]", ",", "\[Rho]a", ",", "ua", ",", "\[CurlyEpsilon]a", 
       ",", "snum", ",", "\[IndentingNewLine]", "x", ",", "minv", ",", "maxv",
        ",", "it"}], "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Column", "[", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Deploy", "@", 
         RowBox[{"Panel", "@", 
          RowBox[{"Column", "[", 
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Row", "[", 
              RowBox[{"{", 
               RowBox[{"\"\<Solver: \>\"", ",", "\[IndentingNewLine]", 
                RowBox[{"SetterBar", "[", 
                 RowBox[{
                  RowBox[{"Dynamic", "@", "solver"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    "\"\<Linear\>\"", "\[Rule]", "\"\<Linear advection\>\""}],
                     ",", 
                    RowBox[{
                    "\"\<Nonlinear\>\"", "\[Rule]", "\"\<Ideal gas\>\""}]}], 
                   "}"}]}], "]"}]}], "\[IndentingNewLine]", "}"}], "]"}], ",",
              "\[IndentingNewLine]", 
             RowBox[{"Dynamic", "@", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"solver", "\[Equal]", "\"\<Nonlinear\>\""}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"problem", "=", "\"\<ContactS\>\""}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Row", "[", 
                  RowBox[{"{", 
                   RowBox[{"\"\<Problem: \>\"", ",", "\[IndentingNewLine]", 
                    RowBox[{"SetterBar", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "@", "problem"}], ",", 
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"\"\<ContactS\>\"", "\[Rule]", "\"\<Step\>\""}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{
                    "\"\<ContactT\>\"", "\[Rule]", "\"\<Triangle\>\""}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    "\"\<ContactC\>\"", "\[Rule]", "\"\<Parabola\>\""}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    "\"\<Riemann\>\"", "\[Rule]", 
                    "\"\<Riemann problem\>\""}]}], "\[IndentingNewLine]", 
                    "}"}]}], "]"}]}], "\[IndentingNewLine]", "}"}], "]"}]}], 
                ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"problem", "=", "\"\<Step\>\""}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Row", "[", 
                  RowBox[{"{", 
                   RowBox[{"\"\<Problem: \>\"", ",", "\[IndentingNewLine]", 
                    RowBox[{"SetterBar", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "@", "problem"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\"\<Step\>\"", "\[Rule]", "\"\<Step\>\""}], ",", 
                    
                    RowBox[{
                    "\"\<Triangle\>\"", "\[Rule]", "\"\<Triangle\>\""}], ",", 
                    
                    RowBox[{"\"\<Cap\>\"", "\[Rule]", "\"\<Parabola\>\""}]}], 
                    "}"}]}], "]"}]}], "\[IndentingNewLine]", "}"}], "]"}]}]}],
                "\[IndentingNewLine]", "]"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"Dynamic", "@", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"solver", "\[Equal]", "\"\<Nonlinear\>\""}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"Grid", "[", 
                 RowBox[{
                  RowBox[{"{", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "\"\<\[Gamma], \!\(\*SubscriptBox[\(C\), \
\(p\)]\)/\!\(\*SubscriptBox[\(C\), \(v\)]\) ratio\>\"", ",", 
                    RowBox[{"Slider", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "@", "\[Gamma]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1.05", ",", "3"}], "}"}], ",", 
                    RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}]}], 
                    "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{"\"\<\[Rho]\>\"", ",", 
                    RowBox[{"Dynamic", "[", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"problem", "\[NotEqual]", "\"\<Riemann\>\""}], 
                    ",", "\"\<inner\>\"", ",", "\"\<left\>\""}], "   ", "]"}],
                     "]"}]}], "]"}], ",", 
                    RowBox[{"Slider", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "@", "\[Rho]L"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0.1", ",", "5"}], "}"}], ",", 
                    RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}]}], 
                    "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"\"\<\[Rho]\>\"", ",", 
                    RowBox[{"Dynamic", "[", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"problem", "\[NotEqual]", "\"\<Riemann\>\""}], 
                    ",", "\"\<outer\>\"", ",", "\"\<right\>\""}], "]"}], 
                    "]"}]}], "]"}], ",", 
                    RowBox[{"Slider", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "@", "\[Rho]R"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0.1", ",", "5"}], "}"}], ",", 
                    RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}]}], 
                    "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{"\"\<u\>\"", ",", 
                    RowBox[{"Dynamic", "[", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"problem", "\[NotEqual]", "\"\<Riemann\>\""}], 
                    ",", "\"\<inner\>\"", ",", "\"\<left\>\""}], "   ", "]"}],
                     "]"}]}], "]"}], ",", 
                    RowBox[{"Slider", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "@", "uL"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "5"}], ",", "5"}], "}"}], ",", 
                    RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}]}], 
                    "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"\"\<u\>\"", ",", 
                    RowBox[{"Dynamic", "[", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"problem", "\[NotEqual]", "\"\<Riemann\>\""}], 
                    ",", "\"\<outer\>\"", ",", "\"\<right\>\""}], "]"}], 
                    "]"}]}], "]"}], ",", 
                    RowBox[{"Slider", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "@", "uR"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "5"}], ",", "5"}], "}"}], ",", 
                    RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}]}], 
                    "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", 
                    RowBox[{"Dynamic", "[", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"problem", "\[NotEqual]", "\"\<Riemann\>\""}], 
                    ",", "\"\<inner\>\"", ",", "\"\<left\>\""}], "   ", "]"}],
                     "]"}]}], "]"}], ",", 
                    RowBox[{"Slider", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "@", "\[CurlyEpsilon]L"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0.1", ",", "5"}], "}"}], ",", 
                    RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}]}], 
                    "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", 
                    RowBox[{"Dynamic", "[", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"problem", "\[NotEqual]", "\"\<Riemann\>\""}], 
                    ",", "\"\<outer\>\"", ",", "\"\<right\>\""}], "]"}], 
                    "]"}]}], "]"}], ",", 
                    RowBox[{"Slider", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "@", "\[CurlyEpsilon]R"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0.1", ",", "5"}], "}"}], ",", 
                    RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}]}], 
                    "]"}]}], "}"}]}], "\[IndentingNewLine]", "}"}], ",", 
                  RowBox[{"Alignment", "\[Rule]", "Left"}]}], "]"}], ",", 
                RowBox[{"Spacer", "[", "0", "]"}]}], "]"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Row", "[", 
              RowBox[{"{", 
               RowBox[{
               "\"\<Hybrid scheme order:  \>\"", ",", "\[IndentingNewLine]", 
                RowBox[{"PopupMenu", "[", 
                 RowBox[{
                  RowBox[{"Dynamic", "[", 
                   RowBox[{"schm1", ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"schm1", "=", "#"}], ";", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    "schm1", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], "===", "Null"}], ",", 
                    RowBox[{"schm2", "=", 
                    RowBox[{"schm3", "=", 
                    RowBox[{"schm4", "=", 
                    RowBox[{"{", 
                    RowBox[{"Null", ",", "Null"}], "}"}]}]}]}]}], "]"}]}], 
                    ")"}], "&"}]}], "]"}], ",", "list"}], "]"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"Dynamic", "@", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    "schm2", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], "=!=", "Null"}], ",", 
                   "\"\< \[RightTriangle] \>\"", ",", "\"\<   \>\""}], 
                  "]"}]}], ",", "\[IndentingNewLine]", 
                RowBox[{"PopupMenu", "[", 
                 RowBox[{
                  RowBox[{"Dynamic", "[", 
                   RowBox[{"schm2", ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"schm2", "=", "#"}], ";", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    "schm2", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], "===", "Null"}], ",", 
                    RowBox[{"schm3", "=", 
                    RowBox[{"schm4", "=", 
                    RowBox[{"{", 
                    RowBox[{"Null", ",", "Null"}], "}"}]}]}]}], "]"}]}], 
                    ")"}], "&"}]}], "]"}], ",", "list", ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"Enabled", "\[Rule]", 
                   RowBox[{"Dynamic", "[", 
                    RowBox[{
                    RowBox[{
                    "schm1", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], "=!=", "Null"}], "]"}]}]}], 
                 "]"}], ",", 
                RowBox[{"Dynamic", "@", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    "schm3", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], "=!=", "Null"}], ",", 
                   "\"\< \[RightTriangle] \>\"", ",", "\"\<   \>\""}], 
                  "]"}]}], ",", "\[IndentingNewLine]", 
                RowBox[{"PopupMenu", "[", 
                 RowBox[{
                  RowBox[{"Dynamic", "[", 
                   RowBox[{"schm3", ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"schm3", "=", "#"}], ";", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    "schm3", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], "===", "Null"}], ",", 
                    RowBox[{"schm4", "=", 
                    RowBox[{"{", 
                    RowBox[{"Null", ",", "Null"}], "}"}]}]}], "]"}]}], ")"}], 
                    "&"}]}], "]"}], ",", "list", ",", "\[IndentingNewLine]", 
                  RowBox[{"Enabled", "\[Rule]", 
                   RowBox[{"Dynamic", "[", 
                    RowBox[{
                    RowBox[{
                    "schm2", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], "=!=", "Null"}], "]"}]}]}], 
                 "]"}], ",", 
                RowBox[{"Dynamic", "@", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    "schm4", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], "=!=", "Null"}], ",", 
                   "\"\< \[RightTriangle] \>\"", ",", "\"\<   \>\""}], 
                  "]"}]}], ",", "\[IndentingNewLine]", 
                RowBox[{"PopupMenu", "[", 
                 RowBox[{
                  RowBox[{"Dynamic", "[", 
                   RowBox[{"schm4", ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"schm4", "=", "#"}], ")"}], "&"}]}], "]"}], ",", 
                  "list", ",", "\[IndentingNewLine]", 
                  RowBox[{"Enabled", "\[Rule]", 
                   RowBox[{"Dynamic", "[", 
                    RowBox[{
                    RowBox[{
                    "schm3", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], "=!=", "Null"}], "]"}]}]}], 
                 "]"}]}], "\[IndentingNewLine]", "}"}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Row", "[", 
              RowBox[{"{", 
               RowBox[{"\"\<Speps between output:  \>\"", ",", 
                RowBox[{"Slider", "[", 
                 RowBox[{
                  RowBox[{"Dynamic", "@", "iprint"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"{", 
                    RowBox[{
                    "1", ",", "2", ",", "5", ",", "10", ",", "20", ",", "50", 
                    ",", "100"}], "}"}], "}"}], ",", 
                  RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}]}], 
                 "]"}]}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"Dynamic", "@", 
              RowBox[{"Row", "[", 
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Button", "[", 
                  RowBox[{"\"\<Run\>\"", ",", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"running", "=", "True"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"progress", "=", "0"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"deltas1", "=", 
                    RowBox[{"CoeffToDeltas", "[", "schm1", "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"deltas2", "=", 
                    RowBox[{"CoeffToDeltas", "[", "schm2", "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"deltas3", "=", 
                    RowBox[{"CoeffToDeltas", "[", "schm3", "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"deltas4", "=", 
                    RowBox[{"CoeffToDeltas", "[", "schm4", "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"dt", "=", 
                    RowBox[{"InitializeSolver", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    "solver", ",", "\[Gamma]", ",", "\[IndentingNewLine]", 
                    "problem", ",", "M", ",", 
                    RowBox[{"N", "@", "\[Sigma]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"N", "@", "\[Rho]L"}], ",", 
                    RowBox[{"N", "@", "uL"}], ",", 
                    RowBox[{"N", "@", "\[CurlyEpsilon]L"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"N", "@", "\[Rho]R"}], ",", 
                    RowBox[{"N", "@", "uR"}], ",", 
                    RowBox[{"N", "@", "\[CurlyEpsilon]R"}]}], 
                    "\[IndentingNewLine]", "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"sol", "=", 
                    RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"!", 
                    RowBox[{"NumericQ", "[", "dt", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Print", "[", "dt", "]"}], ";", 
                    RowBox[{"Return", "[", "]"}]}]}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"deltas1", "=!=", "Null"}], ",", 
                    RowBox[{"AddScheme", "[", 
                    RowBox[{"N", "@", 
                    RowBox[{"Flatten", "@", "deltas1"}]}], "]"}]}], "]"}], 
                    ";", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"deltas2", "=!=", "Null"}], ",", 
                    RowBox[{"AddScheme", "[", 
                    RowBox[{"N", "@", 
                    RowBox[{"Flatten", "@", "deltas2"}]}], "]"}]}], "]"}], 
                    ";", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"deltas3", "=!=", "Null"}], ",", 
                    RowBox[{"AddScheme", "[", 
                    RowBox[{"N", "@", 
                    RowBox[{"Flatten", "@", "deltas3"}]}], "]"}]}], "]"}], 
                    ";", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"deltas4", "=!=", "Null"}], ",", 
                    RowBox[{"AddScheme", "[", 
                    RowBox[{"N", "@", 
                    RowBox[{"Flatten", "@", "deltas4"}]}], "]"}]}], "]"}], 
                    ";", "\[IndentingNewLine]", 
                    RowBox[{"it", "=", "0"}], ";", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"sol", ",", "time", ",", "steps"}], "}"}], "=", 
                    RowBox[{
                    RowBox[{"Reap", "[", 
                    RowBox[{"While", "[", 
                    RowBox[{"running", ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"progress", "+=", 
                    RowBox[{"iprint", " ", "dt"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Sow", "[", 
                    RowBox[{
                    RowBox[{"DoSteps", "[", "iprint", "]"}], ",", 
                    "\"\<sol\>\""}], "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"Sow", "[", 
                    RowBox[{"progress", ",", "\"\<time\>\""}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Sow", "[", 
                    RowBox[{
                    RowBox[{"it", "+=", "iprint"}], ",", "\"\<steps\>\""}], 
                    "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"progress", "\[GreaterEqual]", "T"}], ",", 
                    RowBox[{"running", "=", "False"}]}], "]"}]}]}], 
                    "\[IndentingNewLine]", "]"}], "]"}], 
                    "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
                    ";", "\[IndentingNewLine]", 
                    RowBox[{"frame", "=", 
                    RowBox[{"Min", "[", 
                    RowBox[{"frame", ",", 
                    RowBox[{"Length", "@", "sol"}]}], "]"}]}], ";"}], 
                   "\[IndentingNewLine]", ",", 
                   RowBox[{"Method", "\[Rule]", "\"\<Queued\>\""}]}], "]"}], 
                 ",", "\[IndentingNewLine]", 
                 RowBox[{"Spacer", "[", "10", "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Button", "[", 
                  RowBox[{"\"\<Stop\>\"", ",", "\[IndentingNewLine]", 
                   RowBox[{"running", "=", "False"}], "\[IndentingNewLine]", 
                   ",", 
                   RowBox[{"Method", "\[Rule]", "\"\<Preemptive\>\""}]}], 
                  "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Spacer", "[", "10", "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"ProgressIndicator", "[", 
                  RowBox[{
                   FractionBox["progress", "T"], ",", 
                   RowBox[{"ImageSize", "\[Rule]", "450"}]}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], "]"}]}]}], 
            "\[IndentingNewLine]", "}"}], "]"}]}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Deploy", "@", 
         RowBox[{"Animator", "[", 
          RowBox[{
           RowBox[{"Dynamic", "@", "frame"}], ",", 
           RowBox[{"Dynamic", "@", 
            RowBox[{"{", 
             RowBox[{"1", ",", 
              RowBox[{
               RowBox[{"Dimensions", "[", "sol", "]"}], 
               "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
              "1"}], "}"}]}], ",", 
           RowBox[{"Enabled", "\[Rule]", 
            RowBox[{"Dynamic", "[", 
             RowBox[{
              RowBox[{"Length", "[", "sol", "]"}], ">", "0"}], "]"}]}], ",", 
           RowBox[{"AnimationRunning", "\[Rule]", "False"}], ",", 
           RowBox[{"ImageSize", "\[Rule]", "Large"}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Dynamic", "@", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Dimensions", "[", "sol", "]"}], "\[LeftDoubleBracket]", 
             "1", "\[RightDoubleBracket]"}], ">", "0"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Dimensions", "[", "sol", "]"}], 
               "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], ">", 
              "3"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"\[Rho]a", "=", 
               RowBox[{"sol", "\[LeftDoubleBracket]", 
                RowBox[{"frame", ",", "1"}], "\[RightDoubleBracket]"}]}], ";",
               "\[IndentingNewLine]", 
              RowBox[{"ua", "=", 
               RowBox[{"sol", "\[LeftDoubleBracket]", 
                RowBox[{"frame", ",", "2"}], "\[RightDoubleBracket]"}]}], ";",
               "\[IndentingNewLine]", 
              RowBox[{"\[CurlyEpsilon]a", "=", 
               RowBox[{"sol", "\[LeftDoubleBracket]", 
                RowBox[{"frame", ",", "3"}], "\[RightDoubleBracket]"}]}], ";",
               "\[IndentingNewLine]", 
              RowBox[{"\[Rho]", "=", 
               RowBox[{"sol", "\[LeftDoubleBracket]", 
                RowBox[{"frame", ",", "4"}], "\[RightDoubleBracket]"}]}], ";",
               "\[IndentingNewLine]", 
              RowBox[{"u", "=", 
               RowBox[{"sol", "\[LeftDoubleBracket]", 
                RowBox[{"frame", ",", "5"}], "\[RightDoubleBracket]"}]}], ";",
               "\[IndentingNewLine]", 
              RowBox[{"\[CurlyEpsilon]", "=", 
               RowBox[{"sol", "\[LeftDoubleBracket]", 
                RowBox[{"frame", ",", "6"}], "\[RightDoubleBracket]"}]}], ";",
               "\[IndentingNewLine]", 
              RowBox[{"snum", "=", 
               RowBox[{"sol", "\[LeftDoubleBracket]", 
                RowBox[{"frame", ",", "7"}], "\[RightDoubleBracket]"}]}], ";",
               "\[IndentingNewLine]", "\[IndentingNewLine]", 
              RowBox[{"minv", "=", 
               RowBox[{"Min", "[", 
                RowBox[{"Flatten", "@", 
                 RowBox[{"sol", "\[LeftDoubleBracket]", 
                  RowBox[{";;", ",", 
                   RowBox[{"1", ";;", "6"}]}], "\[RightDoubleBracket]"}]}], 
                "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"maxv", "=", 
               RowBox[{"Max", "[", 
                RowBox[{"Flatten", "@", 
                 RowBox[{"sol", "\[LeftDoubleBracket]", 
                  RowBox[{";;", ",", 
                   RowBox[{"1", ";;", "6"}]}], "\[RightDoubleBracket]"}]}], 
                "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"minv", "=", 
               RowBox[{"Max", "[", 
                RowBox[{"minv", ",", 
                 RowBox[{"-", "20"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"maxv", "=", 
               RowBox[{"Min", "[", 
                RowBox[{"maxv", ",", "20"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"x", "=", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Range", "[", 
                   RowBox[{"Length", "@", "\[Rho]"}], "]"}], "-", "0.5"}], 
                 ")"}], "/", 
                RowBox[{"Length", "@", "\[Rho]"}]}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"Row", "[", 
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"ListLinePlot", "[", 
                  RowBox[{
                   RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Transpose", "[", 
                    RowBox[{"{", 
                    RowBox[{"x", ",", "\[Rho]"}], "}"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Transpose", "[", 
                    RowBox[{"{", 
                    RowBox[{"x", ",", "\[CurlyEpsilon]"}], "}"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Transpose", "[", 
                    RowBox[{"{", 
                    RowBox[{"x", ",", "u"}], "}"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Transpose", "[", 
                    RowBox[{"{", 
                    RowBox[{"x", ",", "\[Rho]a"}], "}"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Transpose", "[", 
                    RowBox[{"{", 
                    RowBox[{"x", ",", "\[CurlyEpsilon]a"}], "}"}], "]"}], ",",
                     "\[IndentingNewLine]", 
                    RowBox[{"Transpose", "[", 
                    RowBox[{"{", 
                    RowBox[{"x", ",", "ua"}], "}"}], "]"}]}], 
                    "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
                   
                   RowBox[{"PlotStyle", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Directive", "[", 
                    RowBox[{"Thick", ",", "Red"}], "]"}], ",", 
                    RowBox[{"Directive", "[", 
                    RowBox[{"Thick", ",", "Blue"}], "]"}], ",", 
                    RowBox[{"Directive", "[", 
                    RowBox[{"Thick", ",", "Green"}], "]"}], ",", 
                    RowBox[{"Directive", "[", 
                    RowBox[{"Dashed", ",", "Red"}], "]"}], ",", 
                    RowBox[{"Directive", "[", 
                    RowBox[{"Dashed", ",", "Blue"}], "]"}], ",", 
                    RowBox[{"Directive", "[", 
                    RowBox[{"Dashed", ",", "Green"}], "]"}]}], "}"}]}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"PlotLabel", "\[Rule]", 
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"Row", "[", 
                    RowBox[{"{", 
                    RowBox[{"\"\<Time = \>\"", ",", 
                    RowBox[{
                    "time", "\[LeftDoubleBracket]", "frame", 
                    "\[RightDoubleBracket]"}], ",", "\"\<, step = \>\"", ",", 
                    
                    RowBox[{
                    "steps", "\[LeftDoubleBracket]", "frame", 
                    "\[RightDoubleBracket]"}]}], "}"}], "]"}], ",", "Large"}],
                     "]"}]}], ",", "\[IndentingNewLine]", 
                   RowBox[{"PlotRange", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "1"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"1.1", "minv"}], "-", 
                    RowBox[{"0.1", "maxv"}]}], ",", 
                    RowBox[{
                    RowBox[{"1.1", "maxv"}], "-", 
                    RowBox[{"0.1", "minv"}]}]}], "}"}]}], "}"}]}], ",", 
                   RowBox[{"ImageSize", "\[Rule]", "800"}]}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Deploy", "@", 
                  RowBox[{"Framed", "@", 
                   RowBox[{"Grid", "[", 
                    RowBox[{
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Graphics", "[", 
                    RowBox[{"{", 
                    RowBox[{"Thick", ",", "Red", ",", 
                    RowBox[{"Line", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "0.0001"}], "}"}]}], "}"}], "]"}]}], 
                    "}"}], "]"}], ",", "\"\<\[Rho]\>\""}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Graphics", "[", 
                    RowBox[{"{", 
                    RowBox[{"Thick", ",", "Blue", ",", 
                    RowBox[{"Line", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "0.0001"}], "}"}]}], "}"}], "]"}]}], 
                    "}"}], "]"}], ",", "\"\<\[CurlyEpsilon]\>\""}], "}"}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Graphics", "[", 
                    RowBox[{"{", 
                    RowBox[{"Thick", ",", "Green", ",", 
                    RowBox[{"Line", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "0.0001"}], "}"}]}], "}"}], "]"}]}], 
                    "}"}], "]"}], ",", "\"\<u\>\""}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Graphics", "[", 
                    RowBox[{"{", 
                    RowBox[{"Dashed", ",", "Red", ",", 
                    RowBox[{"Line", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "0.0001"}], "}"}]}], "}"}], "]"}]}], 
                    "}"}], "]"}], ",", 
                    "\"\<\!\(\*SubscriptBox[\(\[Rho]\), \(exact\)]\)\>\""}], 
                    "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Graphics", "[", 
                    RowBox[{"{", 
                    RowBox[{"Dashed", ",", "Blue", ",", 
                    RowBox[{"Line", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "0.0001"}], "}"}]}], "}"}], "]"}]}], 
                    "}"}], "]"}], ",", 
                    "\"\<\!\(\*SubscriptBox[\(\[CurlyEpsilon]\), \(exact\)]\)\
\>\""}], "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Graphics", "[", 
                    RowBox[{"{", 
                    RowBox[{"Dashed", ",", "Green", ",", 
                    RowBox[{"Line", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "0.0001"}], "}"}]}], "}"}], "]"}]}], 
                    "}"}], "]"}], ",", 
                    "\"\<\!\(\*SubscriptBox[\(u\), \(exact\)]\)\>\""}], 
                    "}"}]}], "\[IndentingNewLine]", "}"}], ",", 
                    RowBox[{"Alignment", "\[Rule]", "Left"}]}], "]"}]}]}]}], 
                "\[IndentingNewLine]", "}"}], "]"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"\[Rho]a", "=", 
               RowBox[{"sol", "\[LeftDoubleBracket]", 
                RowBox[{"frame", ",", "1"}], "\[RightDoubleBracket]"}]}], ";",
               "\[IndentingNewLine]", 
              RowBox[{"\[Rho]", "=", 
               RowBox[{"sol", "\[LeftDoubleBracket]", 
                RowBox[{"frame", ",", "2"}], "\[RightDoubleBracket]"}]}], ";",
               "\[IndentingNewLine]", 
              RowBox[{"snum", "=", 
               RowBox[{"sol", "\[LeftDoubleBracket]", 
                RowBox[{"frame", ",", "3"}], "\[RightDoubleBracket]"}]}], ";",
               "\[IndentingNewLine]", "\[IndentingNewLine]", 
              RowBox[{"minv", "=", 
               RowBox[{"Min", "[", 
                RowBox[{"Flatten", "@", 
                 RowBox[{"sol", "\[LeftDoubleBracket]", 
                  RowBox[{";;", ",", 
                   RowBox[{"1", ";;", "2"}]}], "\[RightDoubleBracket]"}]}], 
                "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"maxv", "=", 
               RowBox[{"Max", "[", 
                RowBox[{"Flatten", "@", 
                 RowBox[{"sol", "\[LeftDoubleBracket]", 
                  RowBox[{";;", ",", 
                   RowBox[{"1", ";;", "2"}]}], "\[RightDoubleBracket]"}]}], 
                "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"minv", "=", 
               RowBox[{"Max", "[", 
                RowBox[{"minv", ",", 
                 RowBox[{"-", "3"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"maxv", "=", 
               RowBox[{"Min", "[", 
                RowBox[{"maxv", ",", "3"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"x", "=", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Range", "[", 
                   RowBox[{"Length", "@", "\[Rho]"}], "]"}], "-", "0.5"}], 
                 ")"}], "/", 
                RowBox[{"Length", "@", "\[Rho]"}]}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"Row", "[", 
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"ListLinePlot", "[", 
                  RowBox[{
                   RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Transpose", "[", 
                    RowBox[{"{", 
                    RowBox[{"x", ",", "\[Rho]"}], "}"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Transpose", "[", 
                    RowBox[{"{", 
                    RowBox[{"x", ",", "\[Rho]a"}], "}"}], "]"}]}], 
                    "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{",", 
                    RowBox[{"Transpose", "[", 
                    RowBox[{"{", 
                    RowBox[{"x", ",", "snum"}], "}"}], "]"}]}], "*)"}], 
                    "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
                   
                   RowBox[{"PlotStyle", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Directive", "[", 
                    RowBox[{"Thick", ",", "Red"}], "]"}], ",", 
                    RowBox[{"Directive", "[", 
                    RowBox[{"Dashed", ",", "Red"}], "]"}]}], 
                    RowBox[{"(*", 
                    RowBox[{",", "Thick"}], "*)"}], "}"}]}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"PlotLabel", "\[Rule]", 
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"Row", "[", 
                    RowBox[{"{", 
                    RowBox[{"\"\<Time = \>\"", ",", 
                    RowBox[{
                    "time", "\[LeftDoubleBracket]", "frame", 
                    "\[RightDoubleBracket]"}], ",", "\"\<, step = \>\"", ",", 
                    
                    RowBox[{
                    "steps", "\[LeftDoubleBracket]", "frame", 
                    "\[RightDoubleBracket]"}]}], "}"}], "]"}], ",", "Large"}],
                     "]"}]}], ",", "\[IndentingNewLine]", 
                   RowBox[{"PlotRange", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "1"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"1.1", "minv"}], "-", 
                    RowBox[{"0.1", "maxv"}]}], ",", 
                    RowBox[{
                    RowBox[{"1.1", "maxv"}], "-", 
                    RowBox[{"0.1", "minv"}]}]}], "}"}]}], "}"}]}], ",", 
                   RowBox[{"ImageSize", "\[Rule]", "800"}]}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Deploy", "@", 
                  RowBox[{"Framed", "@", 
                   RowBox[{"Grid", "[", 
                    RowBox[{
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Graphics", "[", 
                    RowBox[{"{", 
                    RowBox[{"Thick", ",", "Red", ",", 
                    RowBox[{"Line", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "0.0001"}], "}"}]}], "}"}], "]"}]}], 
                    "}"}], "]"}], ",", "\"\<\[Rho]\>\""}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Graphics", "[", 
                    RowBox[{"{", 
                    RowBox[{"Dashed", ",", "Red", ",", 
                    RowBox[{"Line", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "0.0001"}], "}"}]}], "}"}], "]"}]}], 
                    "}"}], "]"}], ",", 
                    "\"\<\!\(\*SubscriptBox[\(\[Rho]\), \(exact\)]\)\>\""}], 
                    "}"}]}], "\[IndentingNewLine]", "}"}], ",", 
                    RowBox[{"Alignment", "\[Rule]", "Left"}]}], "]"}]}]}]}], 
                "\[IndentingNewLine]", "}"}], "]"}]}]}], 
            "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
           RowBox[{"Spacer", "[", "10", "]"}]}], 
          RowBox[{"(*", "Else", "*)"}], "\[IndentingNewLine]", "]"}]}]}], 
       "\[IndentingNewLine]", "}"}], "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]}], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10005.},
 FontFamily->"DejaVu Sans Mono"]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Main window", "Subsubtitle"]], "Input",
 Evaluatable->False,
 CellGroupingRules->{GroupTogetherGrouping, 10006.}],

Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Column", "[", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{"TabView", "[", 
      RowBox[{
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"\"\<Scheme info\>\"", "\[Rule]", "\[IndentingNewLine]", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"CalculateSchemes", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"stencil", ",", "\[Sigma]"}], "}"}], ",", "C3"}], 
             "]"}], ";", 
            RowBox[{"AnalyzeScheme", "[", 
             RowBox[{"\[Sigma]", ",", "C3", ",", "schmlist"}], "]"}]}], 
           ")"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"\"\<Solver\>\"", "\[Rule]", "\[IndentingNewLine]", 
          RowBox[{"Solver", "[", 
           RowBox[{
           "schm1", ",", "schm2", ",", "schm3", ",", "schm4", ",", "schmlist",
             ",", "\[IndentingNewLine]", "M", ",", "\[Sigma]", ",", "solver", 
            ",", "problem", ",", "T", ",", "\[Gamma]", ",", "\[Rho]L", ",", 
            "uL", ",", "\[CurlyEpsilon]L", ",", "\[Rho]R", ",", "uR", ",", 
            "\[CurlyEpsilon]R", ",", "\[IndentingNewLine]", "progress", ",", 
            "iprint", ",", "sol", ",", "frame", ",", "time", ",", "steps"}], 
           "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "}"}], 
       ",", 
       RowBox[{"Dynamic", "[", "tabn", "]"}]}], "]"}], "\[IndentingNewLine]", 
     "}"}], "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"localStencil", ",", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "False", ",", "False", ",", "False", ",", "False", ",", "False"}], 
          "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"3", ",", "1", ",", "2", ",", "4", ",", "False"}], "}"}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
          "False", ",", "False", ",", "False", ",", "False", ",", "False"}], 
          "}"}]}], "}"}]}], "\[IndentingNewLine]", "}"}], ",", 
     RowBox[{"ControlType", "\[Rule]", "None"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"stencil", ",", "Null"}], "}"}], ",", 
     RowBox[{"ControlType", "\[Rule]", "None"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Important", " ", "schemes"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"C3", ",", 
       RowBox[{"{", 
        RowBox[{"Null", ",", "Null"}], "}"}]}], "}"}], ",", 
     RowBox[{"ControlType", "\[Rule]", "None"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"User", " ", "chosen", " ", "schemes"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"schm0", ",", 
       RowBox[{"{", 
        RowBox[{"Null", ",", "Null"}], "}"}]}], "}"}], ",", 
     RowBox[{"ControlType", "\[Rule]", "None"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"schm1", ",", 
       RowBox[{"{", 
        RowBox[{"Null", ",", "Null"}], "}"}]}], "}"}], ",", 
     RowBox[{"ControlType", "\[Rule]", "None"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"schm2", ",", 
       RowBox[{"{", 
        RowBox[{"Null", ",", "Null"}], "}"}]}], "}"}], ",", 
     RowBox[{"ControlType", "\[Rule]", "None"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"schm3", ",", 
       RowBox[{"{", 
        RowBox[{"Null", ",", "Null"}], "}"}]}], "}"}], ",", 
     RowBox[{"ControlType", "\[Rule]", "None"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"schm4", ",", 
       RowBox[{"{", 
        RowBox[{"Null", ",", "Null"}], "}"}]}], "}"}], ",", 
     RowBox[{"ControlType", "\[Rule]", "None"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"User", " ", "selected", " ", "schemes"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"schmlist", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"Null", ",", "Null"}], "}"}], "\[Rule]", "\"\<None\>\""}], 
        "}"}]}], "}"}], ",", 
     RowBox[{"ControlType", "\[Rule]", "None"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Step", "-", 
     RowBox[{"related", " ", "params"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"M", ",", "100"}], "}"}], ",", 
     RowBox[{"ControlType", "\[Rule]", "None"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"h", ",", "0.01"}], "}"}], ",", 
     RowBox[{"ControlType", "\[Rule]", "None"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\[Tau]", ",", "0.005"}], "}"}], ",", 
     RowBox[{"ControlType", "\[Rule]", "None"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"T", ",", "1"}], "}"}], ",", 
     RowBox[{"ControlType", "\[Rule]", "None"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\[Sigma]", ",", "0.5"}], "}"}], ",", 
     RowBox[{"ControlType", "\[Rule]", "None"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Current", " ", "tab"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"tabn", ",", "1"}], "}"}], ",", 
     RowBox[{"ControlType", "\[Rule]", "None"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Problem", ":", " ", 
     RowBox[{"Contact", " ", "or", " ", "Riemann"}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"solver", ",", "\"\<Linear\>\""}], "}"}], ",", 
     RowBox[{"ControlType", "\[Rule]", "None"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"problem", ",", "\"\<Contact\>\""}], "}"}], ",", 
     RowBox[{"ControlType", "\[Rule]", "None"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\[Gamma]", ",", "1.4"}], "}"}], ",", 
     RowBox[{"ControlType", "\[Rule]", "None"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"Gas", " ", "parameters"}], " ", "-", " ", "density"}], ",", 
     " ", 
     RowBox[{"velosity", " ", "and", " ", "internal", " ", "energy"}]}], " ", 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\[Rho]L", ",", "1."}], "}"}], ",", 
     RowBox[{"ControlType", "\[Rule]", "None"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"uL", ",", "1."}], "}"}], ",", 
     RowBox[{"ControlType", "\[Rule]", "None"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\[CurlyEpsilon]L", ",", "2.5"}], "}"}], ",", 
     RowBox[{"ControlType", "\[Rule]", "None"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\[Rho]R", ",", ".5"}], "}"}], ",", 
     RowBox[{"ControlType", "\[Rule]", "None"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"uR", ",", "1."}], "}"}], ",", 
     RowBox[{"ControlType", "\[Rule]", "None"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\[CurlyEpsilon]R", ",", "5."}], "}"}], ",", 
     RowBox[{"ControlType", "\[Rule]", "None"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Other", " ", "dynamic", " ", "values"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"progress", ",", "0"}], "}"}], ",", 
     RowBox[{"ControlType", "\[Rule]", "None"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"iprint", ",", "10"}], "}"}], ",", 
     RowBox[{"ControlType", "\[Rule]", "None"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"sol", ",", 
       RowBox[{"{", "}"}]}], "}"}], ",", 
     RowBox[{"ControlType", "\[Rule]", "None"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"time", ",", 
       RowBox[{"{", "}"}]}], "}"}], ",", 
     RowBox[{"ControlType", "\[Rule]", "None"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"steps", ",", 
       RowBox[{"{", "}"}]}], "}"}], ",", 
     RowBox[{"ControlType", "\[Rule]", "None"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"frame", ",", "1"}], "}"}], ",", 
     RowBox[{"ControlType", "\[Rule]", "None"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"Row", "[", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Dynamic", "[", 
       RowBox[{"StencilBox", "[", 
        RowBox[{"stencil", ",", "localStencil", ",", "\[Sigma]"}], "]"}], 
       "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Spacer", "[", "10", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Dynamic", "[", 
       RowBox[{"StepsBox", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "1"}], "}"}], ",", "M", ",", "h", ",", "\[Sigma]",
          ",", "\[Tau]", ",", "T"}], "]"}], "]"}]}], "\[IndentingNewLine]", 
     "}"}], "]"}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10006.},
 FontFamily->"DejaVu Sans Mono"]
}, Closed]]
},
WindowSize->{1278, 976},
WindowMargins->{{0, Automatic}, {2, Automatic}},
ShowSelection->True,
TrackCellChangeTimes->False,
FrontEndVersion->"8.0 for Linux x86 (64-bit) (October 10, 2011)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[579, 22, 203, 4, 37, "Input",
 Evaluatable->False,
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[785, 28, 905, 21, 84, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}]
}, Closed]],
Cell[CellGroupData[{
Cell[1727, 54, 168, 3, 31, "Input",
 Evaluatable->False,
 CellGroupingRules->{GroupTogetherGrouping, 10001.}],
Cell[1898, 59, 23409, 558, 2199, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10001.}]
}, Closed]],
Cell[CellGroupData[{
Cell[25344, 622, 157, 3, 31, "Input",
 Evaluatable->False,
 CellGroupingRules->{GroupTogetherGrouping, 10002.}],
Cell[25504, 627, 3460, 90, 480, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10002.}]
}, Closed]],
Cell[CellGroupData[{
Cell[29001, 722, 176, 3, 31, "Input",
 Evaluatable->False,
 CellGroupingRules->{GroupTogetherGrouping, 10003.}],
Cell[29180, 727, 21625, 505, 1321, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10003.}]
}, Closed]],
Cell[CellGroupData[{
Cell[50842, 1237, 150, 2, 31, "Input",
 Evaluatable->False,
 CellGroupingRules->{GroupTogetherGrouping, 10004.}],
Cell[50995, 1241, 33769, 830, 2530, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10004.}]
}, Closed]],
Cell[CellGroupData[{
Cell[84801, 2076, 143, 2, 31, "Input",
 Evaluatable->False,
 CellGroupingRules->{GroupTogetherGrouping, 10005.}],
Cell[84947, 2080, 42482, 895, 3237, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10005.}]
}, Closed]],
Cell[CellGroupData[{
Cell[127466, 2980, 137, 2, 31, "Input",
 Evaluatable->False,
 CellGroupingRules->{GroupTogetherGrouping, 10006.}],
Cell[127606, 2984, 10211, 289, 1189, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10006.}]
}, Closed]]
}
]
*)

(* End of internal cache information *)
